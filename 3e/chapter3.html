<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><link href="style.css" rel="stylesheet" type="text/css" /><title>Pythonで退屈な作業を自動化する
</title></head><body><div type="frontmatter" class="calibre" id="calibre_link-0">






<div type="bodymatter" class="calibre" id="calibre_link-60">
<section type="chapter" role="doc-chapter" aria-labelledby="ch3">
<span role="doc-pagebreak" type="pagebreak" id="calibre_link-1160" aria-label="49"></span>
<hgroup>
<h2 class="title" id="calibre_link-1455">
<span class="tpt"><span class="sans_dogma_ot_bold_b_">3</span></span> <span class="ct"><span class="sans_dogma_ot_bold_b_">ループ</span></span>
</h2>
</hgroup>
<figure class="opener"><img class="opener1" src="images/000112.jpg" role="presentation" alt="" />
</figure>
<p class="introtni">前章では、プログラムに特定のブロックを実行させて別のブロックを飛ばさせる方法を説明しました。フロー制御はこれだけではありません。本章では、ループを使ってブロックを繰り返し実行する方法を説明します。Pythonには、<span class="sans_thesansmonocd_w5regular_">while</span>と<span class="sans_thesansmonocd_w5regular_">for</span>の2種類のループがあります。これらを使うと1秒で何百万回もコードを実行できるので、自動化の力を最大限に発揮できます。<i class="calibre18">モジュール</i>と呼ばれるコードライブラリをインポートする方法も説明します。これにより利用できる関数を増やすことができます。</p>
<section type="division" aria-labelledby="sec1">
<h3 class="h" id="calibre_link-1456"><span id="calibre_link-61"></span><span class="sans_futura_std_bold_b_">whileループ文</span></h3>
<p class="tni"><span class="thesansmonocd_w5regular_">while</span>文を使うとコードを何度も繰り返し実行できます。while文の条件が<span class="thesansmonocd_w5regular_">True</span>である限り、<span class="thesansmonocd_w5regular_">while</span>節のコードが実行されます。<span class="thesansmonocd_w5regular_">while</span>文は常に次のような形になります。</p>
<ul class="ul">
<li class="bl"><span class="thesansmonocd_w5regular_">while</span>というキーワード</li>
<li class="bl">条件（<span class="thesansmonocd_w5regular_">True</span>または<span class="thesansmonocd_w5regular_">False</span>に評価される式）</li>
<li class="bl">コロン</li>
<li class="bl">インデントされたコードブロック（<span class="thesansmonocd_w5regular_">while</span>節または<span class="thesansmonocd_w5regular_">while</span>ブロックと呼ばれます）</li>
</ul>
<p class="tx"><span class="thesansmonocd_w5regular_">while</span>文は<span class="thesansmonocd_w5regular_">if</span>文と似ていますが、動作が違います。<span class="thesansmonocd_w5regular_">if</span>節が終わるとプログラムの実行はそのあとから継続します。<span class="thesansmonocd_w5regular_">while</span>節が終わるとプログラムの実行は<span class="thesansmonocd_w5regular_">while</span>文の先頭に戻ります。<span class="thesansmonocd_w5regular_">while</span>節は<i class="calibre5">whileループ</i>（あるいは単に<i class="calibre5">ループ</i>）と呼ばれることが多いです。</p>
<p class="tx">条件が同じで実行するプログラムも同じである<span class="thesansmonocd_w5regular_">if</span>文と<span class="thesansmonocd_w5regular_">while</span>ループの動作を比べてみましょう。こちらが<span class="thesansmonocd_w5regular_">if</span>文のコードです。</p>
<pre class="pre"><code class="calibre9">spam = 0
if spam &lt; 5:
    print('Hello, world.')
    spam = spam + 1
</code></pre>
<p class="tx">こちらが<span class="thesansmonocd_w5regular_">while</span>文のコードです。</p>
<pre class="pre"><code class="calibre9">spam = 0
while spam &lt; 5:
    print('Hello, world.')
    spam = spam + 1
</code></pre>
<p class="tx">この2つのコードはよく似ています。<span class="thesansmonocd_w5regular_">if</span>文も<span class="thesansmonocd_w5regular_">while</span>文も<span class="thesansmonocd_w5regular_">spam</span>の値を確認し、5よりも小さければメッセージを表示します。しかしこの2つのコードを実行すると、大きな違いがあります。<span class="thesansmonocd_w5regular_">if</span>文では<span class="thesansmonocd_w5regular_">"Hello, world."</span>が一度だけ表示されます。<span class="thesansmonocd_w5regular_">while</span>文では<span class="thesansmonocd_w5regular_">"Hello, world."</span>が5回繰り返し表示されます。図3-1と図3-2のフローチャートを見比べてください。</p>
<span role="doc-pagebreak" type="pagebreak" id="calibre_link-1458" aria-label="51"></span>
<figure class="img"><img class="img3" id="calibre_link-681" src="images/000085.jpg" alt="" />
<figcaption><p class="cap"><span class="sans_futura_std_book_oblique_i_">図 3-1：if文のコードのフローチャート</span></p></figcaption>
</figure>
<p class="tx"><span class="thesansmonocd_w5regular_">if</span>文のコードは条件を確認し、その条件が真であれば<span class="thesansmonocd_w5regular_">Hello, world.</span>を一度だけ表示します。<span class="thesansmonocd_w5regular_">while</span>ループのコードは5回表示します。<span class="thesansmonocd_w5regular_">spam</span>に格納される整数はループごとに1つずつ増えていきますから、5回繰り返したあとには<span class="thesansmonocd_w5regular_">spam &lt; 5</span>が<span class="thesansmonocd_w5regular_">False</span>になります。</p>
<span role="doc-pagebreak" type="pagebreak" id="calibre_link-1312" aria-label="52"></span>
<figure class="img"><img class="img1" id="calibre_link-682" src="images/000086.jpg" alt="" />
<figcaption><p class="cap"><span class="sans_futura_std_book_oblique_i_">図 3-2：while文のコードのフローチャート</span></p></figcaption>
</figure>
<p class="tx"><span class="thesansmonocd_w5regular_">while</span>ループでは条件が<i class="calibre5">反復（イテレーション）</i>ごとに判定されます。つまり、ループが実行されるごとに条件が判定されます。条件が<span class="thesansmonocd_w5regular_">True</span>であれば節が実行され、そのあとで条件が再び判定されます。条件が<span class="thesansmonocd_w5regular_">False</span>になると、<span class="thesansmonocd_w5regular_">while</span>節が飛ばされます。</p>
<section type="division" aria-labelledby="sec2">
<h4 class="h1" id="calibre_link-1459"><span id="calibre_link-62"></span><span class="sans_futura_std_heavy_oblique_bi_">厄介なwhileループ</span></h4>
<p class="tni">これは文字通りに<span class="sans_thesansmonocd_w7bold_b_">your name（あなたの名前）</span>の入力を求め続けるサンプルプログラムです。Muエディタの画面上部の<span class="listbullet_menuarrow">新規</span>ボタンを押し、以下のコードを入力して、<i class="calibre5">yourName.py</i>という名前で保存してください。</p>
<pre class="pre"><code class="calibre9">name = ''
while name != 'your name':
    print('Please type your name.')
    name = input('&gt;')
print('Thank you!')
</code></pre>
<p class="tx">このプログラムでは、まず、変数<span class="thesansmonocd_w5regular_">name</span>に空文字列を設定します。<span class="thesansmonocd_w5regular_">name !=</span> <span class="thesansmonocd_w5regular_">'your name'</span>の条件は<span class="thesansmonocd_w5regular_">True</span>ですから、<span class="thesansmonocd_w5regular_">while</span>ループ節を実行します。</p>
<p class="tx">while節ではユーザーに名前の入力を求め、入力された値を変数<span class="thesansmonocd_w5regular_">name</span>に代入します。while節の最終行に達したので、ループの最初に戻り、条件を再評価します。<span class="thesansmonocd_w5regular_">name</span>の値が<span class="thesansmonocd_w5regular_">'your name'</span><i class="calibre5">でなければ</i>、条件は<span class="thesansmonocd_w5regular_">True</span>になり、<span class="thesansmonocd_w5regular_">while</span>節がもう一度実行されます。</p>
<p class="tx"><span role="doc-pagebreak" type="pagebreak" id="calibre_link-1460" aria-label="53"></span>ユーザーが<span class="thesansmonocd_w5regular_">your name</span>と入力すると、<span class="thesansmonocd_w5regular_">while</span>ループの条件が<span class="thesansmonocd_w5regular_">'your name' !=</span> <span class="thesansmonocd_w5regular_">'your name'</span>となり、<span class="thesansmonocd_w5regular_">False</span>に評価されます。<span class="thesansmonocd_w5regular_">while</span>ループ節を実行せず、残りのプログラムに進みます。図3-3は<i class="calibre5">yourName.py</i>プログラムのフローチャートです。</p>
<figure class="img"><img class="img3" id="calibre_link-685" src="images/000087.jpg" alt="" />
<figcaption><p class="cap"><span class="sans_futura_std_book_oblique_i_">図 3-3：</span> <span class="sans_futura_std_book_">yourName.py</span> <span class="sans_futura_std_book_oblique_i_">プログラムのフローチャート</span></p></figcaption>
</figure>
<p class="tx"><i class="calibre5">yourName.py</i>を動かしてみましょう。F5キーを押すと実行できます。<span class="thesansmonocd_w5regular_">your name</span>以外の内容を何度か入力してから、最後に<span class="thesansmonocd_w5regular_">your name</span>と入力してみてください。</p>
<pre class="pre"><code class="calibre9">Please type your name.
&gt;<b class="calibre10">Al</b>
Please type your name.
&gt;<b class="calibre10">Albert</b>
Please type your name.
&gt;<b class="calibre10">%#@#%*(^&amp;!!!</b>
Please type your name.
&gt;<b class="calibre10">your name</b>
Thank you!
</code></pre>
<p class="tx"><span class="thesansmonocd_w5regular_">your name</span>と入力しない限り、<span class="thesansmonocd_w5regular_">while</span>ループの条件は<span class="thesansmonocd_w5regular_">False</span>にならないので、永遠に入力を求められます。このプログラムでは、<span class="thesansmonocd_w5regular_">input()</span>関数の呼び出しに対して正しい文字列（your name）を入力すると、ループから抜け出せます。条件が常にTrueとなるループを作ってしまうことがあります。次は<span class="thesansmonocd_w5regular_">while</span>ループから抜け出す方法を見てみましょう。</p>
</section>
<section type="division" aria-labelledby="sec3">
<h4 class="h1" id="calibre_link-1461"><span id="calibre_link-63"></span><span class="sans_futura_std_heavy_oblique_bi_">break文</span></h4>
<p class="tni"><span class="thesansmonocd_w5regular_">while</span>ループ節から抜け出す方法があります。<span class="thesansmonocd_w5regular_">break</span>文を実行すると、<span class="thesansmonocd_w5regular_">while</span>ループ節から抜けます。<span class="thesansmonocd_w5regular_">break</span>文は<span class="thesansmonocd_w5regular_">break</span>というキーワードだけから成り立ちます。</p>
<p class="tx"><span class="thesansmonocd_w5regular_">break</span>文を使って先ほどの <i class="calibre5">yourName.py</i>プログラムと同じ動作をするプログラムです。次のコードを<i class="calibre5">yourName2.py</i>という名前で保存してください。</p>
<pre class="pre"><code class="calibre9">while True:
    print('Please type your name.')
    name = input('&gt;')
    if name == 'your name':
        break
print('Thank you!')
</code></pre>
<p class="tx">1行目で<i class="calibre5">無限ループ</i>を作っています。条件が常に<span class="thesansmonocd_w5regular_">True</span>になる<span class="thesansmonocd_w5regular_">while</span> ループです。（<span class="thesansmonocd_w5regular_">True</span>は常に<span class="thesansmonocd_w5regular_">True</span>に評価されます。）このループから抜け出すには、<span class="thesansmonocd_w5regular_">break</span>文の実行が必要です。（抜け道のない無限ループというバグを作ってしまうことがよくあります。）</p>
<p class="tx">先のプログラムと同様に、ユーザーに<span class="thesansmonocd_w5regular_">your name</span>の入力を求めます。今回は<span class="thesansmonocd_w5regular_">while</span>ループの中で<span class="thesansmonocd_w5regular_">if</span>文を使い、<span class="thesansmonocd_w5regular_">name</span>が<span class="thesansmonocd_w5regular_">'your name'</span>に等しいかどうかを確認しています。その条件が<span class="thesansmonocd_w5regular_">True</span>になれば、<span class="thesansmonocd_w5regular_">break</span>文を実行します。そして、ループから出て、<span class="thesansmonocd_w5regular_">print('Thank you!')</span> を実行します。それ以外の場合は、<span class="thesansmonocd_w5regular_">break</span>文を含む<span class="thesansmonocd_w5regular_">if</span>節は飛ばされ、<span class="thesansmonocd_w5regular_">while</span>ループの最後に到達します。ここまで来たら、<span class="thesansmonocd_w5regular_">while</span>文の最初に戻り、条件を再確認します。whileループの条件は<span class="thesansmonocd_w5regular_">True</span>というブール値ですから、ループの中に入り、もう一度<span class="thesansmonocd_w5regular_">your name</span>の入力をユーザーに求めます。図3-4はこのプログラムのフローチャートです。</p>
<span role="doc-pagebreak" type="pagebreak" id="calibre_link-1051" aria-label="55"></span>
<figure class="img"><img class="img3" id="calibre_link-687" src="images/000088.jpg" alt="" />
<figcaption><p class="cap"><span class="sans_futura_std_book_oblique_i_">図 3-4：無限ループの</span><span class="sans_futura_std_book_">yourName2.py</span><span class="sans_futura_std_book_oblique_i_">プログラムのフローチャート。ループの条件が常に</span><span class="sans_thesansmonocd_w5regular_italic_">True</span><span class="sans_futura_std_book_oblique_i_">ですから、X印の経路をたどることは絶対にありません。</span></p></figcaption>
</figure>
<p class="tx"><i class="calibre5">yourName2.py</i>を実行して、<i class="calibre5">yourName.py</i>を実行したときと同じように試してみてください。どちらも同じように動作するはずです。</p>
</section>
<section type="division" aria-labelledby="sec4">
<h4 class="h1" id="calibre_link-1462"><span id="calibre_link-64"></span><span class="sans_futura_std_heavy_oblique_bi_">continue文</span></h4>
<p class="tni"><span class="thesansmonocd_w5regular_">break</span>文と同じように、<span class="thesansmonocd_w5regular_">continue</span>文はループの中で使います。<span class="thesansmonocd_w5regular_">continue</span>文を実行すると、ループの最初に戻り、ループの条件を再評価します。（ループの最後まで到達したときの動作と同じです。）</p>
<aside class="box" aria-label="box-6">
<p class="bt" id="calibre_link-1463"><span role="doc-pagebreak" type="pagebreak" id="calibre_link-1194" aria-label="56"></span><span class="sans_futura_std_bold_b_">無限ループに陥ったら</span></p>
<p class="btni"><span class="sans_futura_std_book_">無限ループに陥ったらCTRL-Cを押してください。</span><span class="thesansmonocd_w5regular_">KeyboardInterrupt</span><span class="sans_futura_std_book_">エラーが送出され、プログラムが直ちに停止します。Muウィンドウの上部にある停止ボタンをクリックしても構いません。単純な無限ループを作って</span><span class="sans_futura_std_book_oblique_i_">infiniteLoop.py</span>という名前で保存し、プログラムの停止を試してみてください。<span class="sans_futura_std_book_">Muからプログラムを実行している場合は、停止ボタンを押すこともできます。</p>
<pre class="pre"><code class="calibre9"><span class="thesansmonocd_w5regular_">while True:</span>
    print('Hello, world!')
</code></pre>
<p class="boxb-last"><span class="sans_futura_std_book_">このプログラムを実行すると、</span><span class="thesansmonocd_w5regular_">Hello, world!</span><span class="sans_futura_std_book_">が画面に表示され続けます。</span><span class="thesansmonocd_w5regular_">while</span><span class="sans_futura_std_book_">文の条件が常に</span><span class="thesansmonocd_w5regular_">True</span><span class="sans_futura_std_book_">だからです。CTRL-C は無限ループだけでなく直ちにプログラムを停止したいときによく使います。</p>
</aside>
<p class="tx"><span class="thesansmonocd_w5regular_">continue</span>を使い、名前とパスワードを尋ねるプログラムを書いてみましょう。以下のコードを<i class="calibre5">swordfish.py</i>という名前で保存してください。</p>
<pre class="pre"><code class="calibre9">while True:
    print('Who are you?')
    name = input('&gt;')
  <span class="code_codeannotation" aria-label="annotation1">❶</span> if name != 'Joe':
      <span class="code_codeannotation" aria-label="annotation2">❷</span> continue
    print('Hello, Joe. What is the password? (It is a fish.)')
  <span class="code_codeannotation" aria-label="annotation3">❸</span> password = input('&gt;')
    if password == 'swordfish':
        <span class="code_codeannotation" aria-label="annotation4">❹</span> break
<span class="codeannotated_codeannotation" aria-label="annotation5">❺</span> print('Access granted.')   
</code></pre>
<p class="tx">ユーザーが<span class="thesansmonocd_w5regular_">Joe</span>以外の名前を入力すると（<span class="codeannotation" aria-label="annotation1">➊</span>）、<span class="thesansmonocd_w5regular_">continue</span>文（<span class="codeannotation" aria-label="annotation2">➋</span>）によりループの最初に戻ります。条件を再評価し、値が<span class="thesansmonocd_w5regular_">True</span>なので、ループの中に入ります。（ユーザーが<span class="thesansmonocd_w5regular_">Joe</span>という名前を入力して）<span class="thesansmonocd_w5regular_">if</span>文を突破すると、パスワードの入力が求められます（<span class="codeannotation" aria-label="annotation3">➌</span>）。<span class="thesansmonocd_w5regular_">swordfish</span>というパスワードが入力されると、<span class="thesansmonocd_w5regular_">break</span>文（<span class="codeannotation" aria-label="annotation4">➍</span>）が実行され、<span class="thesansmonocd_w5regular_">while</span>ループを抜けて、<span class="thesansmonocd_w5regular_">Access granted</span>と表示されます（<span class="codeannotation" aria-label="annotation5">➎</span>）。それ以外のパスワードが入力されると、<span class="thesansmonocd_w5regular_">while</span>ループの最後に到達し、ループの最初に戻ります。図3-5&lt;はこのプログラムのフローチャートです。</p>
<span role="doc-pagebreak" type="pagebreak" id="calibre_link-1464" aria-label="57"></span>
<figure class="img"><img class="img1" id="calibre_link-689" src="images/000089.jpg" alt="" />
<figcaption><p class="cap"><span class="sans_futura_std_book_oblique_i_">図 3-5：</span><span class="sans_futura_std_book_">swordfish.py</span> <span class="sans_futura_std_book_oblique_i_">プログラムのフローチャート。ループの条件は常に</span><span class="sans_thesansmonocd_w5regular_italic_">True</span><span class="sans_futura_std_book_oblique_i_">ですから、X印の経路をたどることは絶対にありません。</span></p></figcaption>
</figure>
<p class="tx"><span role="doc-pagebreak" type="pagebreak" id="calibre_link-975" aria-label="58"></span>このプログラムを実行して、入力を試してみてください。Joeと入力するまで、プログラムはパスワードの入力を求めることはありません。正しいパスワードを入力すると、プログラムは終了します。</p>
<pre class="pre"><code class="calibre9">Who are you?
&gt;<b class="calibre10">I'm fine, thanks. Who are you?</b>
Who are you?
&gt;<b class="calibre10">Joe</b>
Hello, Joe. What is the password? (It is a fish.)
&gt;<b class="calibre10">Mary</b>
Who are you?
&gt;<b class="calibre10">Joe</b>
Hello, Joe. What is the password? (It is a fish.)
&gt;<b class="calibre10">swordfish</b>
Access granted.
</code></pre>
<aside class="box" aria-label="box-7">
<p class="bt" id="calibre_link-1465"><span class="sans_futura_std_bold_b_">真っぽい値と偽っぽい値</span></p>
<p class="btni"><span class="sans_futura_std_book_">条件では、ブール型以外のデータ型の値が</span><span class="thesansmonocd_w5regular_">True</span><span class="sans_futura_std_book_">または</span><span class="thesansmonocd_w5regular_">False</span><span class="sans_futura_std_book_">と判定されます。条件では、</span><span class="thesansmonocd_w5regular_">0</span><span class="sans_futura_std_book_">、</span><span class="thesansmonocd_w5regular_">0.0</span><span class="sans_futura_std_book_">、</span><span class="thesansmonocd_w5regular_">''</span><span class="sans_futura_std_book_">（空文字列）は</span><span class="thesansmonocd_w5regular_">False</span><span class="sans_futura_std_book_">だと判定され、その他の値は</span><span class="thesansmonocd_w5regular_">True</span><span class="sans_futura_std_book_">だと判定されます。以下の例を見てください。</span></p>
<pre class="pre"><code class="calibre9"><span class="thesansmonocd_w5regular_">name = ''</span>
<span class="codeannotated_codeannotation" aria-label="annotation1">❶</span> while not name:
    print('Enter your name:')
    name = input('&gt;')
print('How many guests will you have?')
num_of_guests = int(input('&gt;'))
<span class="codeannotated_codeannotation" aria-label="annotation2">❷</span> if num_of_guests:
    <span class="codeannotated_codeannotation" aria-label="annotation3">❸</span> print('Be sure to have enough room for all your guests.')
print('Done')
</code></pre>
<p class="boxb-last"><span class="sans_futura_std_book_">ユーザーが</span><span class="thesansmonocd_w5regular_">name</span><span class="sans_futura_std_book_">に空白文字列を入力すると、</span><span class="thesansmonocd_w5regular_">while</span><span class="sans_futura_std_book_">文の条件が</span><span class="thesansmonocd_w5regular_">True</span>になり（<span class="codeannotation" aria-label="annotation1">➊</span><span class="sans_futura_std_book_">）、プログラムは名前の入力を求め続けます。</span><span class="thesansmonocd_w5regular_">num_of_guests</span><span class="sans_futura_std_book_">の値が0でなければ（</span><span class="codeannotation" aria-label="annotation2">➋</span><span class="sans_futura_std_book_">）、条件が</span><span class="thesansmonocd_w5regular_">True</span><span class="sans_futura_std_book_">になり、リマインダを表示します（</span><span class="codeannotation" aria-label="annotation3">➌</span><span class="sans_futura_std_book_">）。</span></p>
<p class="boxb-last"><span class="thesansmonocd_w5regular_">not name</span><span class="sans_futura_std_book_">の代わりに</span><span class="thesansmonocd_w5regular_">not name !=</span> <span class="thesansmonocd_w5regular_">''</span><span class="sans_futura_std_book_">、</span><span class="thesansmonocd_w5regular_">num_of_guests</span><span class="thesansmonocd_w5regular_">の代わりに</span><span class="thesansmonocd_w5regular_">num_of_guests !=</span> <span class="thesansmonocd_w5regular_">0</span><span class="sans_futura_std_book_">と書くこともできますが、真っぽい値や偽っぽい値を使うとコードが読みやすくなります。</span></p>
<p class="boxb-last"><span class="sans_futura_std_book_">ある値が真っぽい値か偽っぽい値かを知りたければ、</span><span class="thesansmonocd_w5regular_">bool()</span><span class="sans_futura_std_book_">関数に渡してください。以下に例を示します。</span></p>
<pre class="pre"><code class="calibre9"><span class="thesansmonocd_w5regular_">&gt;&gt;&gt;</span> <b class="calibre10">bool(0)</b>
<span role="doc-pagebreak" type="pagebreak" id="calibre_link-1158" aria-label="59"></span>False
&gt;&gt;&gt; <b class="calibre10">bool(42)</b>
True
&gt;&gt;&gt; <b class="calibre10">bool('Hello')</b>
True
&gt;&gt;&gt; <b class="calibre10">bool('')</b>
False
</code></pre>
</aside>
</section>
</section>
<section type="division" aria-labelledby="sec5">
<h3 class="h" id="calibre_link-1466"><span id="calibre_link-65"></span><span class="sans_futura_std_bold_b_">forループとrange()関数</span></h3>
<p class="tni"><span class="thesansmonocd_w5regular_">while</span>ループでは条件が<span class="thesansmonocd_w5regular_">True</span>である間はループの実行を繰り返しますが、コードブロックを一定回数実行したいときにはどうすればよいでしょうか。<span class="thesansmonocd_w5regular_">for</span>ループ文と<span class="thesansmonocd_w5regular_">range()</span>関数を使います。</p>
<p class="tx"><span class="thesansmonocd_w5regular_">for</span>文は<span class="thesansmonocd_w5regular_">for i in range(5):</span>のような形で使います。</p>
<ul class="ul">
<li class="bl"><span class="thesansmonocd_w5regular_">for</span>というキーワード</li>
<li class="bl">変数名</li>
<li class="bl"><span class="thesansmonocd_w5regular_">in</span>というキーワード</li>
<li class="bl"><span class="thesansmonocd_w5regular_">range()</span>関数の呼び出し（最大3つの引数）</li>
<li class="bl">コロン</li>
<li class="bl">インデントされたコードブロック（<span class="thesansmonocd_w5regular_">for</span>節または<span class="thesansmonocd_w5regular_">for</span>ブロックと呼ばれます）</li>
</ul>
<p class="tx"><span class="thesansmonocd_w5regular_">for</span>ループの動作を確認するために新しいプログラムを書いて、<i class="calibre5">fiveTimes.py</i>という新しい名前で保存します。</p>
<pre class="pre"><code class="calibre9">print('Hello!')
for i in range(5):
    print('On this iteration, i is set to ' + str(i))
print('Goodbye!')
</code></pre>
<p class="tx"><span class="thesansmonocd_w5regular_">for</span>ループの節が5回実行されます。1回目の実行時には、変数<span class="thesansmonocd_w5regular_">i</span>に<span class="thesansmonocd_w5regular_">0</span>が設定されます。ループ節で<span class="thesansmonocd_w5regular_">print()</span>関数を呼び出し、<span class="thesansmonocd_w5regular_">On this iteration, i is set to 0</span>を表示します。<span class="thesansmonocd_w5regular_">for</span>ループ節の実行を終えるとループの最初に戻り、<span class="thesansmonocd_w5regular_">for</span>文の<span class="thesansmonocd_w5regular_">i</span>を1増加させます。このようにして<span class="thesansmonocd_w5regular_">range(5)</span>が節の実行を5回繰り返します。<span class="thesansmonocd_w5regular_">i</span>が<span class="thesansmonocd_w5regular_">0</span>、<span class="thesansmonocd_w5regular_">1</span>、<span class="thesansmonocd_w5regular_">2</span>、<span class="thesansmonocd_w5regular_">3</span>、<span class="thesansmonocd_w5regular_">4</span>と増えていきます。変数<span class="thesansmonocd_w5regular_">i</span>は、<span class="thesansmonocd_w5regular_">range()</span>関数に渡された整数まで増加していきます（その整数は含みません）。図3-6は<i class="calibre5">fiveTimes.py</i>プログラムのフローチャートです。</p>
<span role="doc-pagebreak" type="pagebreak" id="calibre_link-1171" aria-label="60"></span>
<figure class="img"><img class="img3" id="calibre_link-691" src="images/000090.jpg" alt="" />
<figcaption><p class="cap"><span class="sans_futura_std_book_oblique_i_">図 3-6：</span><span class="sans_futura_std_book_">fiveTimes.py</span><span class="sans_futura_std_book_oblique_i_">プログラムのフローチャート</span></p></figcaption>
</figure>
<p class="tx">プログラムの出力はこのようになります。</p>
<pre class="pre"><code class="calibre9">Hello!
On this iteration, i is set to 0
On this iteration, i is set to 1
On this iteration, i is set to 2
On this iteration, i is set to 3
On this iteration, i is set to 4

Goodbye!
</code></pre>
<p class="tx"><span class="thesansmonocd_w5regular_">for</span>ループでも<span class="thesansmonocd_w5regular_">break</span>文と<span class="thesansmonocd_w5regular_">continue</span>文を使うことができます。<span class="thesansmonocd_w5regular_">continue</span>文は<span class="thesansmonocd_w5regular_">for</span>ループのカウンターを次の数に進めて実行を続けます。ループの最後に到達してループの最初に戻るのと同じ要領です。<span class="thesansmonocd_w5regular_">continue</span>文と<span class="thesansmonocd_w5regular_">break</span>文を使えるのは、<span class="thesansmonocd_w5regular_">while</span>ループと<span class="thesansmonocd_w5regular_">for</span>ループの中だけです。それ以外の場所で使おうとしたら、エラーが発生します。</p>
<p class="tx"><span class="thesansmonocd_w5regular_">for</span>ループの別の例を見てみましょう。数学者ガウスの逸話をもとにしています。ガウスは少年時代に先生から手間のかかる問題を出されました。0から100までを全部足すという問題です。ガウスは賢い方法を思いついて数秒で答えを出しましたが、<span class="thesansmonocd_w5regular_">for</span>ループを使って（愚直に）その計算をするプログラムを書けます。</p>
<pre class="pre"><code class="calibre9">total = 0
for num in range(101):
    total = total + num
print(total)  
</code></pre>
<p class="tx"><span role="doc-pagebreak" type="pagebreak" id="calibre_link-1026" aria-label="61"></span>答えは5,050になるはずです。プログラムの実行開始時に変数<span class="thesansmonocd_w5regular_">total</span>の値を<span class="thesansmonocd_w5regular_">0</span>に設定します。<span class="thesansmonocd_w5regular_">for</span>ループで、<span class="thesansmonocd_w5regular_">total</span> <span class="thesansmonocd_w5regular_">=</span> <span class="thesansmonocd_w5regular_">total</span> <span class="thesansmonocd_w5regular_">+</span> <span class="thesansmonocd_w5regular_">num</span>を101回実行します。毎回変数<span class="thesansmonocd_w5regular_">num</span>の値が1ずつ増えていきます。<span class="thesansmonocd_w5regular_">0</span>から<span class="thesansmonocd_w5regular_">100</span>まで101回繰り返して<span class="thesansmonocd_w5regular_">total</span>で合計を得ます。<span class="thesansmonocd_w5regular_">total</span>を画面に表示します。非常に遅いコンピュータでも、これくらいのプログラムでしたら1秒もかからないでしょう。</p>
<p class="tx">（ガウス少年は数秒でこの問題を解く方法を見つけました。1 + 100, 2 + 99, 3 + 98…50 + 51と、合計すると101になるペアが50組あります。50 × 101は5,050ですから、0から100までの合計は5,050です。賢い子どもです。）</p>
<aside class="box" aria-label="box-8">
<p class="bt" id="calibre_link-1467"><span class="sans_futura_std_bold_b_">なぜその数値までであってその数値を含まないのか</span></p>
<p class="btni"><span class="thesansmonocd_w5regular_">for</span><span class="sans_futura_std_book_">ループの</span><span class="thesansmonocd_w5regular_">range()</span><span class="sans_futura_std_book_">関数で指定した数値よりも1小さい数までしかループしないのが奇妙に思われるかもしれません。プログラミングでは、「閉区間、開区間」形式で範囲を指定する場合が多いです。開始点は含みますが、終了点は含みません。例えば、0, 10の範囲だと、0は含みますが10は含みません。「閉区間、閉区間」形式ではなく「閉区間、開区間」形式を採用することには、バグを抑える利点があります。その範囲の大きさを計算するときに、終了点から開始点を単純に引き算できます。0, 10の範囲（10は含まず9までです）には、 10 – 0で10の数値があると計算できます。0, 9の「閉区間、閉区間」形式だと、9 – 0 + 1で計算しなければなりません（1を引くという間違いを犯しがちです）。次の範囲は、10, 20のように、前の範囲の終了点の数値を次の範囲の開始点の数値に指定できます。</span></p>
<p class="boxb-last"><span class="sans_futura_std_book_">タイムスタンプを扱うプログラムでは、 00:00:00, 24:00:00.0のような「閉区間、開区間」形式のほうが、00:00:00, 23:59:59.999のような「閉区間、閉区間」形式よりも、圧倒的に扱いやすいです。最初は「閉区間、開区間」形式が奇妙に思われるかもしれませんが、コードを書く経験を積めば自然に思えてきます。</span></p>
</aside>
<section type="division" aria-labelledby="sec6">
<h4 class="h1" id="calibre_link-1468"><span id="calibre_link-66"></span><span class="sans_futura_std_heavy_oblique_bi_">whileループで同じことをする</span></h4>
<p class="tni"><span class="thesansmonocd_w5regular_">for</span>ループと同じことを<span class="thesansmonocd_w5regular_">while</span>ループでもできますが、<span class="thesansmonocd_w5regular_">for</span>ループのほうが簡潔です。<span class="thesansmonocd_w5regular_">for</span>の<i class="calibre5">fiveTimes.py</i>を<span class="thesansmonocd_w5regular_">while</span>ループで書き直してみましょう。</p>
<pre class="pre"><code class="calibre9">print('Hello!')
i = 0
while i &lt; 5:
    print('On this iteration, i is set to ' + str(i))
    i = i + 1
print('Goodbye!')
</code></pre>
<p class="tx">プログラムを実行したときの出力は<span class="thesansmonocd_w5regular_">for</span>ループを使った<i class="calibre5">fiveTimes.py</i>と同じです。<span class="thesansmonocd_w5regular_">for</span>ループは回数を指定してループさせるときに便利で、<span class="thesansmonocd_w5regular_">while</span>ループは特定の条件が満たされる限りループさせるときに便利です。</p>
</section>
<section type="division" aria-labelledby="sec7">
<h4 class="h1" id="calibre_link-1469"><span id="calibre_link-67"></span><span class="sans_futura_std_heavy_oblique_bi_">range()関数の引数</span></h4>
<p class="tni">カンマ区切りで複数の引数を取れる関数があります。<span class="thesansmonocd_w5regular_">range()</span>関数がそうです。<span class="thesansmonocd_w5regular_">range()</span>関数に引数を渡すことで、ゼロ以外の数字から連続する整数を得ることができます。</p>
<pre class="pre"><code class="calibre9">for i in range(12, 16):
    print(i)
</code></pre>
<p class="tx">第一引数は<span class="thesansmonocd_w5regular_">for</span>ループの変数が開始する数値であり、第二引数は終了する数値（その数値は含まない）です。</p>
<pre class="pre"><code class="calibre9">12
13
14
15
</code></pre>
<p class="tx"><span class="thesansmonocd_w5regular_">range()</span>関数に3つの引数を渡すこともできます。第一引数と第二引数は開始と終了で、第三引数は<i class="calibre5">増分</i>です。増分とは、繰り返しごとに変数の値が増やされる量のことです。</p>
<pre class="pre"><code class="calibre9">for i in range(0, 10, 2):
    print(i)
</code></pre>
<p class="tx"><span class="thesansmonocd_w5regular_">range(0, 10, 2)</span>は、0から8まで2ずつ増やしていきます。</p>
<pre class="pre"><code class="calibre9">0
2
4
6
8
</code></pre>
<p class="tx"><span class="thesansmonocd_w5regular_">range()</span>関数は<span class="thesansmonocd_w5regular_">for</span>ループで柔軟に使えます。例えば、増分に負の数を指定すると、<span class="thesansmonocd_w5regular_">for</span>ループでカウントダウンをできます。</p>
<pre class="pre"><code class="calibre9">for i in range(5, -1, -1):
    print(i)
</code></pre>
<p class="tx">この<span class="thesansmonocd_w5regular_">for</span>ループの出力は次のとおりです。</p>
<pre class="pre"><code class="calibre9">5
4
3
2
1
0
</code></pre>
<p class="tx"><span role="doc-pagebreak" type="pagebreak" id="calibre_link-760" aria-label="63"></span><span class="thesansmonocd_w5regular_">range(5, -1, -1)</span>の<span class="thesansmonocd_w5regular_">for</span>ループで<span class="thesansmonocd_w5regular_">i</span>を表示すると、5から0までカウントダウンします。</p>
</section>
</section>
<section type="division" aria-labelledby="sec8">
<h3 class="h" id="calibre_link-1470"><span id="calibre_link-68"></span><span class="sans_futura_std_bold_b_">モジュールのインポート</span></h3>
<p class="tni">Pythonでは、これまで見てきたように、<span class="thesansmonocd_w5regular_">print()</span>、<span class="thesansmonocd_w5regular_">input()</span>、<span class="thesansmonocd_w5regular_">len()</span>などの<i class="calibre5">組み込み関数</i>をどこからでも呼び出せます。組み込み関数とは別に、Pythonには<i class="calibre5">標準ライブラリ</i>と呼ばれるモジュールがあります。各モジュールは、プログラムに組み込むことができる一連の関数を集めたものです。例えば、<span class="thesansmonocd_w5regular_">math</span>モジュールは数学に関連する関数、<span class="thesansmonocd_w5regular_">random</span>モジュールはランダムな数値に関連する関数、といった具合です。</p>
<p class="tx">これらの関数を使う前に、<span class="thesansmonocd_w5regular_">import</span>文でモジュールをインポートしなければなりません。<span class="thesansmonocd_w5regular_">import</span>文は次のように書きます。</p>
<ul class="ul">
<li class="bl"><span class="thesansmonocd_w5regular_">import</span>というキーワード</li>
<li class="bl">モジュール名</li>
<li class="bl">カンマ区切りで複数のモジュールを一度にインポートできます。</li>
</ul>
<p class="tx">モジュールをインポートすると、そのモジュールに含まれるすべての関数を使えるようになります。<span class="thesansmonocd_w5regular_">random</span>モジュールを試してみましょう。<span class="thesansmonocd_w5regular_">random.randint()</span>関数が使えるようになります。</p>
<p class="tx">次のコードを<i class="calibre5">printRandom.py</i>という名前で保存してください。</p>
<pre class="pre"><code class="calibre9">import random
for i in range(5):
    print(random.randint(1, 10))
</code></pre>
<p class="tx">このプログラムを実行すると、次のように出力されます。</p>
<pre class="pre"><code class="calibre9">4
1
8
4
1
</code></pre>
<p class="tx"><span class="thesansmonocd_w5regular_">random.randint()</span>関数を呼び出すと、渡した2つの整数の間でランダムな整数値に評価されます。<span class="thesansmonocd_w5regular_">randint()</span>は<span class="thesansmonocd_w5regular_">random</span>モジュール内にありますから、関数名の前に<span class="sans_thesansmonocd_w7bold_b_">random.</span>とつけなければなりません。そうすればPythonが<span class="thesansmonocd_w5regular_">random</span>モジュール内の関数を探してくれます。</p>
<aside class="box" aria-label="box-9">
<p class="bt" id="calibre_link-1471"><span role="doc-pagebreak" type="pagebreak" id="calibre_link-938" aria-label="64"></span><span class="sans_futura_std_bold_b_">モジュール名を上書きしないてください</span></p>
<p class="btni"><span class="sans_futura_std_book_">自分で書いたPythonスクリプトを保存するときは、</span><span class="sans_futura_std_book_oblique_i_">random.py</span><span class="sans_futura_std_book_">、</span><span class="sans_futura_std_book_oblique_i_">sys.py</span><span class="sans_futura_std_book_">、</span><span class="sans_futura_std_book_oblique_i_">os.py</span><span class="sans_futura_std_book_">、</span><span class="sans_futura_std_book_oblique_i_">math.py</span><span class="sans_futura_std_book_">のようなモジュール名と同じ名前で保存しないように気をつけてください。モジュール名と同じ名前、例えば</span><span class="sans_futura_std_book_oblique_i_">random.py</span><span class="sans_futura_std_book_">という名前で保存してしまうと、</span><span class="thesansmonocd_w5regular_">import random</span><span class="sans_futura_std_book_">文が、Pythonの標準ライブラリである</span><span class="sans_futura_std_book_oblique_i_">random</span><span class="sans_futura_std_book_">ではなく、自分が書いた</span><span class="thesansmonocd_w5regular_">random.py</span><span class="sans_futura_std_book_">をインポートしてしまいます。そうすると、</span><span class="thesansmonocd_w5regular_">AttributeError: module 'random' has no attribute 'randint'</span><span class="sans_futura_std_book_">のようなエラーにつながります。自分が書いた</span><span class="sans_futura_std_book_oblique_i_">random.py</span><span class="sans_futura_std_book_">には、標準モジュールの</span><span class="thesansmonocd_w5regular_">random</span><span class="sans_futura_std_book_">にはあるはずの関数が存在しないからです。組み込み関数の名前も使わないでください。Pythonでよく使うモジュールや組み込み関数の名前（自分で書いたPythonスクリプトを保存する際につけてはいけない名前）は</span> <span class="thesansmonocd_w5regular_">all</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">any</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">date</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">email</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">file</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">format</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">hash</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">id</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">input</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">list</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">min</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">max</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">object</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">open</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">random</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">set</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">str</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">sum</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">test</span><span class="sans_futura_std_book_">、</span> <span class="thesansmonocd_w5regular_">type</span><span class="sans_futura_std_book_">などです。</span></p>
</aside>
<p class="tx">4つのモジュールをインポートする<span class="thesansmonocd_w5regular_">import</span>文の例です。</p>
<pre class="pre"><code class="calibre9">import random, sys, os, math</code></pre>
<p class="tx">これで4つのモジュールの中にある関数が使えるようになります。これらの関数については本書のあとの部分で詳しく学びます。</p>
<p class="tx"><span class="thesansmonocd_w5regular_">import</span>の前に<span class="thesansmonocd_w5regular_">from</span> というキーワードが来る文もあります。<span class="thesansmonocd_w5regular_">from random import *</span>のように、<span class="thesansmonocd_w5regular_">from</span>のあとにモジュール名を書き、<span class="thesansmonocd_w5regular_">import</span>のあとにキーワードやアスタリスク（<span class="thesansmonocd_w5regular_">*</span>）などを書きます。この形で<span class="thesansmonocd_w5regular_">import</span>文を書くと、<span class="thesansmonocd_w5regular_">random</span>モジュール中の関数を呼び出すときに<span class="thesansmonocd_w5regular_">random.</span>をつける必要がなくなります。とはいえ、モジュール名をつけたほうがわかりやすいですから、<span class="thesansmonocd_w5regular_">import random</span>の形の文を書いたほうがよいです。</p>
</section>
<section type="division" aria-labelledby="sec9">
<h3 class="h" id="calibre_link-1472"><span id="calibre_link-69"></span><span class="sans_futura_std_bold_b_">sys.exit()でプログラムを途中で終了する</span></h3>
<p class="tni">フロー制御の説明の締めくくりとしてプログラムを<i class="calibre5">途中で終了</i>する方法をお伝えします。命令の最後に到達したらプログラムの実行は終了します。しかし、<span class="thesansmonocd_w5regular_">sys.exit()</span>関数を呼び出せば、命令の最後に到達する前にプログラムを終了させられます。この関数は<span class="thesansmonocd_w5regular_">sys</span>モジュール内にありますから、使用前に<span class="thesansmonocd_w5regular_">sys</span>をインポートしなければなりません。</p>
<p class="tx">次のコードを<i class="calibre5">exitExample.py</i>という名前で保存してください。</p>
<pre class="pre"><code class="calibre9">import sys

while True:
    print('Type exit to exit.')
    response = input('&gt;')
    if response == 'exit':
<span role="doc-pagebreak" type="pagebreak" id="calibre_link-1182" aria-label="65"></span>        sys.exit()
    print('You typed ' + response + '.')
</code></pre>
<p class="tx">このプログラムを実行してみてください。<span class="thesansmonocd_w5regular_">break</span>文のない無限ループです。このプログラムを終了させるために、<span class="thesansmonocd_w5regular_">sys.exit()</span>を呼び出します。変数<span class="thesansmonocd_w5regular_">response</span>の値が<span class="thesansmonocd_w5regular_">'exit'</span>と等しければ、<span class="thesansmonocd_w5regular_">sys.exit()</span>を呼び出す行が実行されます。変数<span class="thesansmonocd_w5regular_">response</span>は<span class="thesansmonocd_w5regular_">input()</span>関数により設定されますから、ユーザーが<span class="thesansmonocd_w5regular_">exit</span>と入力すればプログラムを終了させられます。</p>
</section>
<section type="division" aria-labelledby="sec10">
<h3 class="h" id="calibre_link-1473"><span id="calibre_link-70"></span><span class="sans_futura_std_bold_b_">短いプログラム：数当てゲーム</span></h3>
<p class="tni">ここまでは例を通じて基本概念を説明してきました。ここからは学んだことを組み合わせてもっと本格的なプログラムを書いてみましょう。この節では、単純な数当てゲームを紹介します。このプログラムを実行すると、次のように出力されます。</p>
<pre class="pre"><code class="calibre9">I am thinking of a number between 1 and 20.
Take a guess.
&gt;<b class="calibre10">10</b>
Your guess is too low.
Take a guess.
&gt;<b class="calibre10">15</b>
Your guess is too low.
Take a guess.
&gt;<b class="calibre10">17</b>
Your guess is too high.
Take a guess.
&gt;<b class="calibre10">16</b>
Good job! You got it in 4 guesses!
</code></pre>
<p class="tx">次のコードを<i class="calibre5">guessTheNumber.py</i>という名前で保存してください。</p>
<pre class="pre"><code class="calibre9"># This is a guess the number game.
import random
secret_number = random.randint(1, 20)
print('I am thinking of a number between 1 and 20.')

# Ask the player to guess 6 times.
for guesses_taken in range(1, 7):
    print('Take a guess.')
    guess = int(input('&gt;'))

    if guess &lt; secret_number:
        print('Your guess is too low.')
    elif guess &gt; secret_number:
        print('Your guess is too high.')
    else:
        break  # This condition is the correct guess!

<span role="doc-pagebreak" type="pagebreak" id="calibre_link-1279" aria-label="66"></span>if guess == secret_number:
    print('Good job! You got it in ' + str(guesses_taken) + ' guesses!')
else:
    print('Nope. The number was ' + str(secret_number))
</code></pre>
<p class="tx">このコードを最初から一行ずつ見ていきましょう。</p>
<pre class="pre"><code class="calibre9"># This is a guess the number game.
import random
secret_number = random.randint(1, 20)
</code></pre>
<p class="tx">1行目はプログラムの動作を説明するコメントです。2行目で<span class="thesansmonocd_w5regular_">random</span>モジュールをインポートしています。あとでユーザーに当ててもらう数を生成するのに<span class="thesansmonocd_w5regular_">random.randint()</span>関数を使うためです。その関数の返り値である1から20までのランダムな整数を、変数<span class="thesansmonocd_w5regular_">secret_number</span>に格納します。</p>
<pre class="pre"><code class="calibre9">print('I am thinking of a number between 1 and 20.')

# Ask the player to guess 6 times.
for guesses_taken in range(1, 7):
    print('Take a guess.')
    guess = int(input('&gt;'))
</code></pre>
<p class="tx">秘密の数があって、それを6回以内に当ててもらいます。プレイヤーが推測した数を入力し、最大6回繰り返す<span class="thesansmonocd_w5regular_">for</span>ループの中で当たっているかどうか確かめます。ループの中ではまずプレイヤーが推測した数を入力します。<span class="thesansmonocd_w5regular_">input()</span>関数は文字列を返しますから、<span class="thesansmonocd_w5regular_">int()</span>関数で文字列を整数値に変換します。それを<span class="thesansmonocd_w5regular_">guess</span>という名前の変数に格納します。</p>
<pre class="pre"><code class="calibre9">    if guess &lt; secret_number:
        print('Your guess is too low.')
    elif guess &gt; secret_number:
        print('Your guess is too high.')
</code></pre>
<p class="tx">この4行では、プレイヤーが推測した数が秘密の数よりも小さいか大きいかを確認しています。どちらの場合も、推測した数が小さすぎるか大きすぎるかのヒントが画面に表示されます。</p>
<pre class="pre"><code class="calibre9">    else:
        break  # This condition is the correct guess!
</code></pre>
<p class="tx">推測した数が大きすぎも小さすぎもしない場合、つまり秘密の数に等しい場合、<span class="thesansmonocd_w5regular_">for</span>ループから抜け出します。</p>
<pre class="pre"><code class="calibre9">if guess == secret_number:
    print('Good job! You got it in ' + str(guesses_taken) + ' guesses!')
else:
    print('Nope. The number was ' + str(secret_number))
</code></pre>
<p class="tx"><span role="doc-pagebreak" type="pagebreak" id="calibre_link-1289" aria-label="67"></span><span class="thesansmonocd_w5regular_">for</span>ループのあとでは、<span class="thesansmonocd_w5regular_">if-else</span>文でプレイヤーが数を当てられたかどうかを確認し、その結果に応じたメッセージを画面に表示しています。どちらの場合も、推測に挑戦した回数の<span class="thesansmonocd_w5regular_">guesses_taken</span>と秘密の数の<span class="thesansmonocd_w5regular_">secret_number</span>の値を表示します。その整数値を文字列と結合するので、整数値を<span class="thesansmonocd_w5regular_">str()</span>関数に渡し、整数値から文字列値を得ています。それらの文字列を<span class="thesansmonocd_w5regular_">+</span>演算子で結合し、最後に<span class="thesansmonocd_w5regular_">print()</span>関数に渡しています。</p>
</section>
<section type="division" aria-labelledby="sec11">
<h3 class="h" id="calibre_link-1474"><span id="calibre_link-71"></span><span class="sans_futura_std_bold_b_">短いプログラム：じゃんけん</span></h3>
<p class="tni">これまでに学んだ概念を使って、簡単なじゃんけんプログラムを作ってみましょう。出力は次のようになります。</p>
<pre class="pre"><code class="calibre9">ROCK, PAPER, SCISSORS
0 Wins, 0 Losses, 0 Ties
Enter your move: (r)ock (p)aper (s)cissors or (q)uit
&gt;<b class="calibre10">p</b>
PAPER versus...
PAPER
It is a tie!
0 Wins, 0 Losses, 1 Ties
Enter your move: (r)ock (p)aper (s)cissors or (q)uit
&gt;<b class="calibre10">s</b>
SCISSORS versus...
PAPER
You win!
1 Wins, 0 Losses, 1 Ties
Enter your move: (r)ock (p)aper (s)cissors or (q)uit
&gt;<b class="calibre10">q</b>
</code></pre>
<p class="tx">次のコードを<i class="calibre5">rpsGame.py</i>という名前で保存してください。</p>
<pre class="pre"><code class="calibre9">import random, sys

print('ROCK, PAPER, SCISSORS')

# These variables keep track of the number of wins, losses, and ties.
wins = 0
losses = 0
ties = 0

while True:  # The main game loop
    print('%s Wins, %s Losses, %s Ties' % (wins, losses, ties))
    while True:  # The player input loop
        print('Enter your move: (r)ock (p)aper (s)cissors or (q)uit')
        player_move = input('&gt;')
        if player_move == 'q':
            sys.exit()  # Quit the program.
<span role="doc-pagebreak" type="pagebreak" id="calibre_link-1475" aria-label="68"></span>        if player_move == 'r' or player_move == 'p' or player_move == 's':
            break  # Break out of the player input loop.
        print('Type one of r, p, s, or q.')

    # Display what the player chose:
    if player_move == 'r':
        print('ROCK versus...')
    elif player_move == 'p':
        print('PAPER versus...')
    elif player_move == 's':
        print('SCISSORS versus...')

    # Display what the computer chose:
    move_number = random.randint(1, 3)
    if move_number == 1:
        computer_move = 'r'
        print('ROCK')
    elif move_number == 2:
        computer_move = 'p'
        print('PAPER')
    elif move_number == 3:
        computer_move = 's'
        print('SCISSORS')

    # Display and record the win/loss/tie:
    if player_move == computer_move:
        print('It is a tie!')
        ties = ties + 1
    elif player_move == 'r' and computer_move == 's':
        print('You win!')
        wins = wins + 1
    elif player_move == 'p' and computer_move == 'r':
        print('You win!')
        wins = wins + 1
    elif player_move == 's' and computer_move == 'p':
        print('You win!')
        wins = wins + 1
    elif player_move == 'r' and computer_move == 'p':
        print('You lose!')
        losses = losses + 1
    elif player_move == 'p' and computer_move == 's':
        print('You lose!')
        losses = losses + 1
    elif player_move == 's' and computer_move == 'r':
        print('You lose!')
        losses = losses + 1
</code></pre>
<p class="tx">このコードを最初から一行ずつ見ていきましょう。</p>
<pre class="pre"><code class="calibre9">import random, sys

print('ROCK, PAPER, SCISSORS')

# These variables keep track of the number of wins, losses, and ties.
wins = 0
<span role="doc-pagebreak" type="pagebreak" id="calibre_link-1476" aria-label="69"></span>losses = 0
ties = 0
</code></pre>
<p class="tx">まず、<span class="thesansmonocd_w5regular_">random</span>モジュールと<span class="thesansmonocd_w5regular_">sys</span>モジュールをインポートしています。あとで<span class="thesansmonocd_w5regular_">random.randint()</span>関数と<span class="thesansmonocd_w5regular_">sys.exit()</span>関数を呼び出すためです。次に、プレイヤーの勝ち数、負け数、引き分け数を格納する3つの変数を初期化しています。</p>
<pre class="pre"><code class="calibre9">while True:  # The main game loop
    print('%s Wins, %s Losses, %s Ties' % (wins, losses, ties))
    while True:  # The player input loop
        print('Enter your move: (r)ock (p)aper (s)cissors or (q)uit')
        player_move = input('&gt;')
        if player_move == 'q':
            sys.exit()  # Quit the program.
        if player_move == 'r' or player_move == 'p' or player_move == 's':
            break  # Break out of the player input loop.
        print('Type one of r, p, s, or q.')
</code></pre>
<p class="tx">このプログラムでは、<span class="thesansmonocd_w5regular_">while</span>ループの中で<span class="thesansmonocd_w5regular_">while</span>ループを使っています。最初の外側のループはメインのゲームを行うループであり、ループの繰り返しがじゃんけんの繰り返しに対応します。2つ目の内側のループは、プレイヤーの入力を待ちます。<span class="thesansmonocd_w5regular_">r</span>、<span class="thesansmonocd_w5regular_">p</span>、<span class="thesansmonocd_w5regular_">s</span>、<span class="thesansmonocd_w5regular_">q</span>が有効な入力です。<span class="thesansmonocd_w5regular_">r</span>、<span class="thesansmonocd_w5regular_">p</span>、<span class="thesansmonocd_w5regular_">s</span>はグー（石を表すrockの頭文字でr）、パー（紙を表すpaperの頭文字でp）、チョキ（はさみを表すscissorsの頭文字でs）に対応します。<span class="thesansmonocd_w5regular_">q</span>は終了（quitの頭文字でq）です。終了の場合は<span class="thesansmonocd_w5regular_">sys.exit()</span> を呼び出してプログラムを終了させます。プレイヤーが<span class="thesansmonocd_w5regular_">r</span>、<span class="thesansmonocd_w5regular_">p</span>、<span class="thesansmonocd_w5regular_">s</span>のどれかを入力したら、内側のループを抜けます。それ以外の入力に対しては、<span class="thesansmonocd_w5regular_">r</span>、<span class="thesansmonocd_w5regular_">p</span>、<span class="thesansmonocd_w5regular_">s</span>、<span class="thesansmonocd_w5regular_">q</span>のいずれかを入力するように促すメッセージを表示して、ループの最初に戻ります。</p>
<pre class="pre"><code class="calibre9">    # Display what the player chose:
    if player_move == 'r':
        print('ROCK versus...')
    elif player_move == 'p':
        print('PAPER versus...')
    elif player_move == 's':
        print('SCISSORS versus...')
</code></pre>
<p class="tx">プレイヤーの手を画面に表示します。</p>
<pre class="pre"><code class="calibre9">    # Display what the computer chose:
    move_number = random.randint(1, 3)
    if move_number == 1:
        computer_move = 'r'
        print('ROCK')
    elif move_number == 2:
        computer_move = 'p'
        print('PAPER')
    elif move_number == 3:
        computer_move = 's'
        print('SCISSORS')
</code></pre>
<p class="tx">次にコンピュータの手をランダムに選びます。<span class="thesansmonocd_w5regular_">random.randint()</span>はランダムな数を返しますから、<span class="thesansmonocd_w5regular_">1</span>、<span class="thesansmonocd_w5regular_">2</span>、<span class="thesansmonocd_w5regular_">3</span>の整数をランダムに選んで<span class="thesansmonocd_w5regular_">move_number</span>という名前の変数に格納します。<span class="thesansmonocd_w5regular_">move_number</span>の整数値に応じて<span class="thesansmonocd_w5regular_">'r'</span>、<span class="thesansmonocd_w5regular_">'p'</span>、<span class="thesansmonocd_w5regular_">'s'</span>という文字列のいずれかを<span class="thesansmonocd_w5regular_">computer_move</span>という名前の変数に格納し、そのコンピュータの手を画面に表示します。</p>
<pre class="pre"><code class="calibre9">    # Display and record the win/loss/tie:
    if player_move == computer_move:
        print('It is a tie!')
        ties = ties + 1
    elif player_move == 'r' and computer_move == 's':
        print('You win!')
        wins = wins + 1
    elif player_move == 'p' and computer_move == 'r':
        print('You win!')
        wins = wins + 1
    elif player_move == 's' and computer_move == 'p':
        print('You win!')
        wins = wins + 1
    elif player_move == 'r' and computer_move == 'p':
        print('You lose!')
        losses = losses + 1
    elif player_move == 'p' and computer_move == 's':
        print('You lose!')
        losses = losses + 1
    elif player_move == 's' and computer_move == 'r':
        print('You lose!')
        losses = losses + 1
</code></pre>
<p class="tx">最後に、<span class="thesansmonocd_w5regular_">player_move</span>（プレイヤーの手）と<span class="thesansmonocd_w5regular_">computer_move</span>（コンピュータの手）を比較して、勝負の結果を画面に表示します。その結果に応じて、<span class="thesansmonocd_w5regular_">wins</span>（勝ち）、<span class="thesansmonocd_w5regular_">losses</span>（負け）、<span class="thesansmonocd_w5regular_">ties</span>（引き分け）変数の値を増やします。プログラムがこの部分に到達すると、外側のメインのループの最初に戻り、次の勝負を始めます。</p>
<p class="tx">このじゃんけんが気に入ったら、 <i class="calibre5">The Big Book of Small Python Projects</i> (No Starch Press, 2021)に収録した他の単純なPythonプログラムのソースコードもご覧ください。</p>
</section>
<section type="conclusion" role="doc-conclusion" aria-labelledby="sec12">
<h3 class="h" id="calibre_link-1477"><span id="calibre_link-72"></span><span class="sans_futura_std_bold_b_">まとめ</span></h3>
<p class="tni">ループを使うと、指定した条件が<span class="thesansmonocd_w5regular_">True</span>である限り繰り返しコードを実行できます。ループから抜けたりループの最初に戻ったりするには、<span class="thesansmonocd_w5regular_">break</span>文と<span class="thesansmonocd_w5regular_">continue</span>文が使えます。</p>
<p class="tx">こうしたフロー制御文を活用すれば、賢いプログラムを書けます。自分で関数を作成することでもフロー制御ができますが、これは次章のテーマとします。</p>
</section>
<section type="division" aria-labelledby="sec13">
<h3 class="h" id="calibre_link-1478"><span id="calibre_link-73"></span><span class="sans_futura_std_bold_b_">練習問題</span></h3>
<p class="listnumber">  1. プログラムが無限ループに陥ったときにどのキーを押しますか？</p>
<p class="listnumber">  2. <span class="thesansmonocd_w5regular_">break</span>と<span class="thesansmonocd_w5regular_">continue</span>の違いを説明してください。</p>
<p class="listnumber"><span role="doc-pagebreak" type="pagebreak" id="calibre_link-1479" aria-label="71"></span>  3. <span class="thesansmonocd_w5regular_">for</span>ループで、<span class="thesansmonocd_w5regular_">range(10)</span>と<span class="thesansmonocd_w5regular_">range(0, 10)</span>と<span class="thesansmonocd_w5regular_">range(0, 10, 1)</span>はどう違いますか？</p>
<p class="listnumber">  4. <span class="thesansmonocd_w5regular_">for</span>ループを使って、<span class="thesansmonocd_w5regular_">1</span>から<span class="thesansmonocd_w5regular_">10</span>までの数を表示するプログラムを書いてください。<span class="thesansmonocd_w5regular_">while</span> ループを使って、<span class="thesansmonocd_w5regular_">1</span>から<span class="thesansmonocd_w5regular_">10</span>までの数を表示するプログラムを書いてください。</p>
<p class="listnumber">  5. <span class="thesansmonocd_w5regular_">spam</span>モジュールの中に<span class="thesansmonocd_w5regular_">bacon()</span>関数があるとしたら、<span class="thesansmonocd_w5regular_">spam</span>モジュールをインポートしたあとでその関数をどのように呼び出しますか？</p>
</section>
</section>
</div>


</div>



</body></html>