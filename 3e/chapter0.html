<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><link href="style.css" rel="stylesheet" type="text/css" /><title>Pythonで退屈な作業を自動化する
</title></head><body><div type="frontmatter" class="calibre" id="calibre_link-0">




<div type="bodymatter" class="calibre" id="calibre_link-3">
<section type="introduction" role="doc-introduction" aria-labelledby="int">
<span role="doc-pagebreak" type="pagebreak" id="calibre_link-1376" aria-label="xxxi"></span>
<hgroup>
<h1 class="fmh" id="calibre_link-1377"><span class="sans_dogma_ot_bold_b_">はじめに
</span></h1>
</hgroup>
<figure class="opener"><img class="opener1" src="images/000112.jpg" role="presentation" alt="" />
</figure>
<p class="introtni">「3人で2日かかる作業を君は2時間で仕上げたんだよ」
私の大学のルームメイトは2000年代の初めに家電量販店で働いていました。
その店では、他店の何千種類もの製品価格をまとめたスプレッドシートを用意していました。
3人の従業員がそのスプレッドシートを印刷して、分厚い紙の束を分担して作業していました。
製品ごとに価格を比較して、他店のほうが安い製品をリストアップしていました。
この作業には数日かかっていました。
</p>
<p class="tx">私のルームメイトは、紙をまき散らして床に座って作業している姿を見て、「この印刷物の元ファイルがあれば、その作業をしてくれるプログラムを書くよ」と言いました。</p>
<p class="tx">数時間後、ファイルから他店の製品価格を読み取り、自店のデータベースから同じ製品の価格を取得して、他店のほうが安ければ記録する短いプログラムを、ルームメイトは書き上げました。そのルームメイトはまだプログラミングの初心者だったので、プログラミング本を読んで調べるのにほとんどの時間を費やしました。プログラムの実行にかかった時間はほんの数秒です。その日、ルームメイトとその家電量販店の従業員は、とても長い昼食をとりました。</p>
<p class="tx">これがコンピュータプログラミングの力です。コンピュータはさまざまな作業に使える万能ツールです。クリックして入力して…という反復作業に時間を浪費している人は多いです。正しい指示を与えればコンピュータは数秒でその作業ができることに気づいていないのでしょう。</p>
<section type="division" aria-labelledby="sec1">
<div class="calibre8"></div><h2 class="h" id="calibre_link-1378"><span id="calibre_link-4"></span><span class="sans_futura_std_bold_b_">対象読者</span></h2>
<p class="tni">私たちが今使っているたくさんのツールの中心にはソフトウェアがあります。多くの人がSNSを使っていて、かばんやポケットの中にはインターネットに接続した電話があり、事務仕事にはコンピュータが欠かせません。その結果、コードを書ける人がますます求められるようになってきています。初心者でも年収1000万円のエンジニアになれると約束する本やオンライン教材やトレーニングコースがあふれています。</p>
<p class="tx">本書はその類ではありません。万人に向けて書いた本です。</p>
<p class="tx">この本を読んだだけでプロのソフトウェア開発者になれるわけではありません。ギターのレッスンを少し受けただけではロックスターになれないのと同じです。事務員であれ管理職であれ研究者であれ、コンピュータを仕事や趣味に使う人なら、本書を読めばプログラミングの基礎を身につけられます。以下のような単純作業を自動化できます。</p>
<ul class="ul">
<li class="bl">数千ファイルの名前を変更してフォルダに整理する</li>
<li class="bl">タイピングせずにオンラインフォームに入力する</li>
<li class="bl">ウェブサイトが更新されたらファイルをダウンロードしたりテキストをコピーしたりする</li>
<li class="bl">コンピュータから携帯電話にメッセージを通知する</li>
<li class="bl">Excelのスプレッドシートを更新したり整形したりする</li>
<li class="bl">メールをチェックして事前に用意した返信を送信する</li>
<li class="bl">データベースを作成して情報を検索する</li>
<li class="bl">画像や音声ファイルから文字を抽出する</li>
</ul>
<p class="tx">こうした作業は単純ですが、人間が行うと時間がかかりますし、状況に特化しているため既製のソフトウェアでは対応できません。しかし、プログラミングの基礎知識があれば、コンピュータにこうした作業をさせることができます。</p>
</section>
<section type="division" aria-labelledby="sec2">
<h2 class="h" id="calibre_link-1379"><span id="calibre_link-5"></span><span class="sans_futura_std_bold_b_">本書のコーディング規約</span></h2>
<p class="tni">この本はリファレンスマニュアルではなく初心者用のガイドブックです。学習の便宜上、コーディングのスタイルがベストプラクティスから逸脱している場合があります（例：グローバル変数の使用）。オブジェクト指向、リスト内包表記、ジェネレータなどの複雑なプログラミングの概念は扱いません。熟練したプログラマはこうしたらもっと効率がよくなるのにと思うかもしれませんが、本書は最小限の労力でプログラムを動作させることに重点を置いています。</p>
</section>
<section type="division" aria-labelledby="sec3">
<h2 class="h" id="calibre_link-1381"><span id="calibre_link-6"></span><span class="sans_futura_std_bold_b_">プログラムとは何か</span></h2>
<p class="tni">テレビ番組や映画では、プログラマが狂ったように0と1の羅列を光り輝くスクリーンに打ち込んでいる姿が映し出されますが、現代のプログラミングはその姿とほど遠いです。<i class="calibre5">プログラミング</i>とは、コンピュータが理解して実行できる指示を書くことです。数値計算、文書編集、情報検索、インターネット通信といった指示です。</p>
<p class="tx">どのようなプログラムも、次のように、基本的な指示を組み合わせています。</p>
<p class="listplain">「これをして、次にあれをする」</p>
<p class="listplain">「この条件が真であればこれをして、偽であればあれをする」</p>
<p class="listplain">「27回これをする」</p>
<p class="listplain">「この条件が真になるまでこれをする」</p>
<p class="tx">こうした基本的な指示を組み合わせてもっと複雑なことができます。以下の例は、Pythonというプログラミング言語で書かれた、<i class="calibre5">ソースコード</i><a id="calibre_link-1382" class="calibre1"></a>と呼ばれるプログラミングの指示です。Pythonのソフトウェアが最初の行から最後の行までコードを実行していきます（条件が真であるが偽であるかによって実行される行が変わります）。</p>
<pre class="pre"><code class="calibre9"><span class="codeannotated_codeannotation" aria-label="annotation1">❶</span> <span class="thesansmonocd_w5regular_">password_file = open('SecretPasswordFile.txt')</span>
<span class="codeannotated_codeannotation" aria-label="annotation2">❷</span> <span class="thesansmonocd_w5regular_">secret_password = password_file.read()</span>
<span class="codeannotated_codeannotation" aria-label="annotation3">❸</span> <span class="thesansmonocd_w5regular_">print('Enter your password.')
typed_password = input()</span>
<span class="codeannotated_codeannotation" aria-label="annotation4">❹</span> <span class="thesansmonocd_w5regular_">if typed_password == secret_password:
  </span><span class="code_codeannotation" aria-label="annotation5">❺</span> <span class="thesansmonocd_w5regular_">print('Access granted')
  </span><span class="code_codeannotation" aria-label="annotation6">❻</span> <span class="thesansmonocd_w5regular_">if typed_password == '12345':
      </span><span class="code_codeannotation" aria-label="annotation7">❼</span> <span class="thesansmonocd_w5regular_">print('That password is one that an idiot puts on their luggage.')
  else:
    </span><span class="codeannotated_codeannotation" aria-label="annotation8">❽</span> <span class="thesansmonocd_w5regular_">print('Access denied')</span>
</code></pre>
<p class="tx">プログラミングがわからなくても、コードを読めば（英語の意味がわかれば）何をしようとしているか推測できるかもしれません。まず、<i class="calibre5">SecretPasswordFile.txt</i>を開き<span class="codeannotation" aria-label="annotation1">(❶)</span>、秘密のパスワードを読み取ります<span class="codeannotation" aria-label="annotation2">(❷)</span>。次に、ユーザーはパスワードを（キーボードから）入力するように求められます<span class="codeannotation" aria-label="annotation3">(❸)</span>。ファイルから読みったパスワードとユーザーが入力したパスワードを比較し<span class="codeannotation" aria-label="annotation4">(❹)</span>、一致すれば<i class="calibre5">Access granted</i>と画面に表示します<span class="codeannotation" aria-label="annotation5">(❺)</span>。そして、パスワードが<i class="calibre5">12345</i>であるかをチェックし<span class="codeannotation" aria-label="annotation6">(❻)</span>、そうであれば不適切なパスワードである旨を表示します<span class="codeannotation" aria-label="annotation7">(❼)</span>。パスワードが一致しなければ、<i class="calibre5">Access denied</i>と画面に表示します<span class="codeannotation" aria-label="annotation8">(❽)</span>。</p>
<p class="tx"><span role="doc-pagebreak" type="pagebreak" id="calibre_link-1244" aria-label="xxxiv"></span>プログラミングは、絵を描いたり、文章を書いたり、編み物をしたり、レゴで城を作ったりするのと同じように創造的な作業です。キャンバスに絵を描くのと同じで、ソフトウェアのプログラミングには制約がありますが無限の可能性に開かれています。プログラミングとその他の創造的な活動との違いは、お使いのコンピュータでプログラミングに必要な原材料が揃っているということです。キャンバス、糸、画材、フィルム、レゴブロック、電子部品のような材料を買う必要はありません。10年落ちのノートパソコンでも十分にプログラミングを書けます。プログラムを一度書けば、何回でも繰り返し使えます。セーターを編んでも一人しか着れませんが、プログラムはオンラインで共有して世界中の人が使えます。</p>
</section>
<section type="division" aria-labelledby="sec4">
<h2 class="h" id="calibre_link-1383"><span id="calibre_link-7"></span><span class="sans_futura_std_bold_b_">Pythonとは何か</span></h2>
<p class="tni"><a id="calibre_link-1384" class="calibre1"></a><i class="calibre5">Python</i> という用語は、プログラミング言語（Pythonのコードには構文が決まっています）とソースコード（プログラミング言語Pythonで書かれたもの）を読んで指示を実行するインタープリタソフトウェアの両方を指します。WindowsでもmacOSでもLinuxでも、 <i class="calibre5"><a href="https://python.org" class="calibre1">https://<wbr></wbr>python<wbr></wbr>.org</a></i> から無料でPythonのインタープリタをダウンロードできます。</p>
<p class="tx">プログラミング言語の種類はいろいろあり、それぞれに強みと弱みがあります。どのプログラミング言語が最高かという議論は好みの違いですから無益です。とはいえ、私見を述べるなら、Pythonが<i class="calibre5">最初に</i>学ぶプログラミング言語として最適です。Pythonの学習曲線はなだらかで、構文が読みやすいです。簡単な作業を行うために複雑な概念を学ぶ必要はありません。プログラミングをさらに極めたければ、最初にPythonを理解していると、次の言語を学ぶのが簡単になります。</p>
<p class="tx">Pythonという名前は、ヘビではなく英国のコメディグループのMonty Pythonに由来しています。Pythonプログラマは親しみを込めてパイソニスタと呼ばれます。チュートリアルなどのドキュメントでは、Monty Pythonとヘビがよく題材に使われます。</p>
</section>
<section type="division" aria-labelledby="sec5">
<h2 class="h" id="calibre_link-1385"><span id="calibre_link-8"></span><span class="sans_futura_std_bold_b_">プログラミングにまつわる神話</span></h2>
<p class="tni">プログラミングはとっつきづらく、有名なソフトウェア会社は大金を稼いでいます。英語のコード（code）という単語には暗号という含意があります。ひと握りの選ばれた人しかプログラムを書けないと考えがちです。しかし、プログラミングは誰でも学べる技術です。以下では、いくつかのよく聞く神話に反論します。</p>
<section type="division" aria-labelledby="sec6">
<h3 class="h1" id="calibre_link-1386"><span id="calibre_link-9"></span><span class="sans_futura_std_heavy_oblique_bi_">プログラマに数学はあまり必要でない</span></h3>
<p class="tni">プログラミングには高度な数学が必要だという神話をよく耳にします。実際には、ほとんどのプログラミング言語で必要な数学は初歩的な計算です。数学よりも論理的に考えて細部に注意を払うことが求められます。プログラミングが得意だというのは、数独のパズルを解くのが得意だということとそう変わりはありません。</p>
<p class="tx">数独は、行、列、3×3の太線の範囲のそれぞれについて、1から9までの数字を埋めるというパズルです。いくつかの数字が入った状態から始めて、それを手がかりに論理的に考えて解いていきます。図1では、5が1行目と2行目に入っているので、1行目と2行目にはもう5を入れることができません。右上の3×3の太線の範囲に着目すると、3行目に5を入れなければなりません。一番右の列にはすでに5が入っていますから、6の右隣に5を入れることはできません。よって、6の左隣に5を入れると確定できます。行、列、3×3の太線の範囲に着目しながら数字を埋めていくと、空白マスを埋める手がかりが増え、そのようにして数字を入れていくと、最終的には全部のマスを埋められます。</p>
<figure class="img"><img class="img1" id="calibre_link-649" src="images/000004.jpg" alt=" " />
<figcaption><p class="cap"><span class="sans_futura_std_book_oblique_i_">図1：数独のパズル例（左図）とその解答（右図）。数独では数字を扱いますが、数学とはあまり関係がありません。（図 © Wikimedia Commons）</span></p></figcaption>
</figure>
<p class="tx">数独が数字に関係あるからといって、数学が得意でないとパズルが解けないわけではありません。プログラミングも同じです。数独のパズルを解くのと同様に、プログラムを書くにも細部に注意を払って問題を順々に解きほぐしていくことが求められます。プログラムの <i class="calibre5">デバッグ</i>（エラーを発見して修正すること）をするにも、プログラムが何をしているか辛抱強く追っていき、バグの原因を突き止めます。どのような技術でもそうですが、やればやるほどうまくなります。</p>
</section>
<section type="division" aria-labelledby="sec7">
<h3 class="h1" id="calibre_link-1388"><span id="calibre_link-10"></span><span class="sans_futura_std_heavy_oblique_bi_">プログラムの学習に年齢は関係ない</span></h3>
<p class="tni">次によく聞く神話は、歳を取りすぎているのでプログラムを学ぶことができないというものです。もう23歳だから遅すぎるといったインターネット上の書き込みをよく目にします。遅すぎることなんてありません。もっと年齢を重ねてからプログラムを学ぶ人はたくさんいます。</p>
<p class="tx">有能なプログラマになるためには幼い頃から学び始めなければならないというのは神話です。しかし、プログラマは天才少年であるというイメージが根強いです。私もこの神話の一端を担っているかもしれません。というのも、私はプログラミングを小学生の頃に始めたからです。</p>
<p class="tx">とはいえ、プログラミングを始めるのは、1990年代よりも今のほうがはるかに簡単です。本がたくさんありますし、検索エンジンの性能も上がっていますし、オンラインの質問回答サイトもたくさんあります。そして何より、プログラミング言語自体が非常に使いやすくなっています。こうした理由から、私が小学生から高校生の間に学んだ内容は、今なら3か月ほど週末に学習すれば追いつけます。私は全然有利な位置にいたわけではなかったのです。</p>
<p class="tx">プログラミングでは向上心が重要です。言い換えると、練習が大事だということです。生まれつきのプログラマなんていませんし、今はプログラミングができなくても才能がないということではありません。</p>
</section>
<section type="division" aria-labelledby="sec8">
<h3 class="h1" id="calibre_link-1390"><span id="calibre_link-11"></span><span class="sans_futura_std_heavy_oblique_bi_">AIがプログラマを不要にはしない</span></h3>
<p class="tni">1990年代には、ナノテクノロジーがあらゆる面において変革をもたらすと喧伝されていました。新しい製造工程と科学革新が社会を変えると言われていました。細菌くらいの大きさのナノボットが炭素原子を1個ずつ組み立てる、カーボンナノチューブとバックミンスターフラーレンと鉛筆の芯と同じくらい安いダイヤモンドが、重量と価格が数分の1なのに鋼鉄よりも10倍硬い素材をもたらすと言われていました。この技術により、<i class="calibre5">スタートレック</i>のレプリケーターのように、宇宙エレベーターでも薬でも電化製品でも何でも作れるとされていました。希少性という経済学の概念が無用になり、世界的な飢餓と戦争を終わらせることを意味していました。ナノボットが蜂起して人間に歯向かわない限り、新しい啓蒙時代をもたらすはずでした。10年後にはそうなると言われていたのです。</p>
<p class="tx">もちろん、そのような誇大広告が実現することはありませんでした。確かにナノテクノロジーが革新をもたらした面はあります（スマートフォンはナノテクノロジーを活用しています）。しかし、スタートレックのレプリケーターのような壮大な約束は果たされず、ナノテクノロジーへの熱狂は現実的な大きさにしぼみました。</p>
<p class="tx">さて、AIについて述べましょう。</p>
<p class="tx">パソコンがあらゆる物事を変えました。インターネットもソーシャルメディアもスマートフォンもあらゆる物事を変えました。暗号通貨はそこまでではありませんが、詐欺に騙されやすい人をあぶり出したかもしれません。今、AIがテクノロジー産業では最新の驚異になっています。通俗的には、<i class="calibre5">AI</i>という用語が、チェスをプレイするコンピュータからチャットボット、いわゆるエキスパートシステム、機械学習まで幅広い内容を指します。本書では、<i class="calibre5">大規模言語モデル（LLM）</i>を指して用います。LLMは、OpenAIのChatGPT、GoogleのGemini、FacebookのLLaMAなど、テキスト生成システムの背景となる概念です。</p>
<p class="tx">LLMについては激しく議論されています。AIが私たちの仕事を奪うのだろうか、もうコードを書くための学習は不要なのか、AIは生きているのか、AIロボットの反乱に立ち向かえるのだろうか、などです。</p>
<p class="tx">LLMの技術はすごいですが、センセーショナルな報道や疑わしい投資機会を勧める人たちの餌食とならずLLMを有効に活用するためには、現実的な期待を設定する必要があります。ここではLLMとコーディングについて、誇大広告ではなく現実的な視点を提供したいと思います。よくある誤解を解いておきます。</p>
<ul class="ul">
<li class="bl">LLMには意識も感覚もありません。</li>
<li class="bl">LLMは人間のソフトウェアエンジニアを不要にすることはありません。</li>
<li class="bl">LLMはプログラミング学習を不要にすることはありません。</li>
<li class="bl"><span role="doc-pagebreak" type="pagebreak" id="calibre_link-1311" aria-label="xxxvii"></span>LLMはそれほど人間の仕事を奪いません（経営陣がそう誤解して従業員を解雇することはあり得ますが）。</li>
<li class="bl">LLMは完全無欠ではなく、<i class="calibre5">よく</i>間違いを犯します。</li>
</ul>
<p class="tx">実際にLLMを使った経験ではなく、SF映画などに基づいてこうした誤解に固執する人がいます。Python Software Foundationの理事でウェブフレームワークDjangoの共同開発者であるSimon Willisonの解説をご覧いただきたいです。AIに関する記事を <i class="calibre5"><a href="https://simonwillison.net/about" class="calibre1">https://<wbr></wbr>simonwillison<wbr></wbr>.net<wbr></wbr>/about</a></i> で読めますし、PyCon 2024での基調講演を <i class="calibre5"><a href="https://autbor.com/pycon2024keynote" class="calibre1">https://<wbr></wbr>autbor<wbr></wbr>.com<wbr></wbr>/pycon2024keynote</a></i> で見られます（英語です）。</p>
<p class="tx">LLMはプログラマにどう役立つのでしょうか。現時点ではっきりしていることは、LLMとのコミュニケーション（プロンプトエンジニアリング）は一つの技術だということです。検索エンジンをうまく使うのが一つの技術であるのと同じです。LLMは人間ではないので、意義があり信頼できる回答を得るためには質問文を工夫する必要があります。LLMは自信満々で不正確な回答をすることがあります。<i class="calibre5">ハルシネーション</i>と呼ばれる現象です。しかしこれはアルゴリズムの擬人化であって正確な表現ではありません。LLMは思考するのではなくテキストを生成します。つまり、LLMの回答は、その内容が正しかろうが正しくなかろうが、<i class="calibre5">すべて</i>ハルシネーションです。</p>
<p class="tx">LLMは目につきやすい大きな間違いを犯すこともあれば、目につきにくい小さな間違いを犯すこともあります。LLMを学習に用いるなら、回答の正確性をチェックしなければなりません。学習段階ではLLMをまったく使わないという選択をするのが妥当です。現在のところ、教育でLLMが有効かどうかは定かではありません。どういう状況であればLLMが学習に役立つか、利点が欠点を上回るかについては、まだ不確かです。</p>
<p class="tx">LLMのの誇大広告に賭ける人がたくさんいても驚きはしません。20世紀のスーパーコンピュータに匹敵するデバイスを私たちはポケットの中に入れているくらいですから。しかもそのデバイスはグローバルなネットワークに接続しています（ネットワーク上の情報は正しいこともあれば正しくないこともありますが）。宇宙空間にある人工衛星からそのデバイスが存在する地球上の位置を特定することもできます。ソフトウェアは魔法のように見えることがありますが、魔法ではありません。プログラミングを学ぶと、コンピュータができることをしっかりと把握して、誇大広告と判別できるようになります。</p>
</section>
</section>
<section type="division" aria-labelledby="sec9">
<h2 class="h" id="calibre_link-1391"><span id="calibre_link-12"></span><span class="sans_futura_std_bold_b_">本書について</span></h2>
<p class="tni">本書の前半の第1部ではPythonプログラミングの基礎を扱います。後半の第2部では多種多様な作業を自動化できるさまざまなソフトウェアライブラリを紹介します。第1部は最初から順番に読むことをおすすめしますが、第2部は興味のある章をつまみ食いして構いません。各章の概要を紹介します。</p>
<p class="listhead"><b class="calibre10">第1部 プログラミングの基礎</b></p>
<p class="listplain"><b class="calibre10">第1章 Pythonの基礎</b>　Pythonの命令の基本形である式を扱います。Python対話型シェルソフトウェアを使ってコードを実行してみる方法も説明します。</p>
<p class="listplain"><span role="doc-pagebreak" type="pagebreak" id="calibre_link-1392" aria-label="xxxviii"></span><b class="calibre10">第2章 if-elseとフロー制御</b>　プログラムがどの命令を実行するか決められる方法を説明します。条件に応じて賢く振る舞えるようになります。</p>
<p class="listplain"><b class="calibre10">第3章 ループ</b>　命令を一定の回数または一定の条件が満たされる間実行する方法を説明します。</p>
<p class="listplain"><b class="calibre10">第4章 関数</b>　自分で関数を定義する方法を説明します。関数を定義すると、コードを整理して管理しやすくなります。</p>
<p class="listplain"><b class="calibre10">第5章 デバッグ</b>　Pythonで利用できる、バグを発見して修正するツールを紹介します。</p>
<p class="listplain"><b class="calibre10">第6章 リスト</b>　リストデータ型を紹介し、データを整理する方法を説明します。</p>
<p class="listplain"><b class="calibre10">第7章 辞書とデータの構造化</b>　辞書データ型を紹介し、データを整理するより強力な方法を説明します。</p>
<p class="listplain"><b class="calibre10">第8章 文字列とテキスト編集</b>　テキストデータ（Pythonでは<i class="calibre5">文字列</i>と呼ばれます）を扱います。</p>
<p class="listhead"><b class="calibre10">第2部 業務自動化</b></p>
<p class="listplain"><b class="calibre10">第9章 正規表現によるテキストパターンマッチング</b>　Pythonで文字列を操作して正規表現でパターンを検索する方法を説明します。</p>
<p class="listplain"><b class="calibre10">第10章 ファイルの読み書き</b>　テキストファイルの中身の読み取りと書き込みを扱います。</p>
<p class="listplain"><b class="calibre10">第11章 ファイルの整理</b>　手動で行うよりも素早く大量のファイルをコピー、移動、リネーム、削除する方法を説明します。ファイルの圧縮と解凍も扱います。</p>
<p class="listplain"><b class="calibre10">第12章 コマンドラインプログラム</b>　Pythonのプログラムを自分のコンピュータや他人のコンピュータで簡単に実行する方法を説明します。</p>
<p class="listplain"><b class="calibre10">第13章 ウェブスクレイピング</b>　ウェブページを自動的にダウンロードして情報を解析するプログラムを書きます。これは<i class="calibre5">ウェブスクレイピング</i>と呼ばれます。</p>
<p class="listplain"><b class="calibre10">第14章 Excelファイル</b>　プログラムからExcelファイルを操作します。大量のExcelファイルを分析する際に役立ちます。</p>
<p class="listplain"><b class="calibre10">第15章 Googleスプレッドシート</b>　GoogleスプレッドシートをPythonで読み書きする方法を説明します。</p>
<p class="listplain"><b class="calibre10">第16章 SQLiteデータベース</b>　リレーショナルデータベースの使い方を説明します。Pythonですぐに使える小規模ながら強力なオープンソースのデータベースであるSQLiteを利用します。</p>
<p class="listplain"><b class="calibre10">第17章 PDFとWord文書</b>　プログラムでWordとPDFの文書を読む方法を説明します。</p>
<p class="listplain"><span role="doc-pagebreak" type="pagebreak" id="calibre_link-1240" aria-label="xxxix"></span><b class="calibre10">第18章 CSV、JSON、XML</b>　データシリアライズフォーマットのCSV、JSON、XMLをプログラムで操作する方法を説明します。</p>
<p class="listplain"><b class="calibre10">第19章 日時、スケジュール、プログラムの起動</b>　Pythonでの日時の扱い方と、コンピュータに指定した時間に作業を実行させる方法を説明します。Pythonから別のプログラムをどのように起動するかも説明します。</p>
<p class="listplain"><b class="calibre10">第20章 メール送信、ショートメール送信、プッシュ通知</b>　メールやショートメールなどで通知を行うプログラムを書く方法を説明します。</p>
<p class="listplain"><b class="calibre10">第21章 グラフ作成と画像処理</b>　JPEGやPNGの画像処理と、Matplotlibライブラリを利用したグラフ作成を説明します。</p>
<p class="listplain"><b class="calibre10">第22章 画像中の文字認識</b>　画像やスキャンした文書から文字を抽出してPyTesseractパッケージで処理する方法を説明します。</p>
<p class="listplain"><b class="calibre10">第23章 キーボードとマウスの制御</b>　クリックとキー入力を自動化するためにマウスとキーボードをプログラムで制御する方法を説明します。</p>
<p class="listplain"><b class="calibre10">第24章 読み上げと音声認識</b>　高度なコンピュータ科学パッケージを使って読み上げと音声認識を行う方法を説明します。</p>
<p class="tx">本書で示したコード例その他の資料を <i class="calibre5"><a href="https://nostarch.com/automate-boring-stuff-python-3rd-edition" class="calibre1">https://<wbr></wbr>nostarch<wbr></wbr>.com<wbr></wbr>/automate<wbr></wbr>-boring<wbr></wbr>-stuff<wbr></wbr>-python<wbr></wbr>-3rd<wbr></wbr>-edition</a></i> でダウンロードできます。<i class="calibre5"><a href="https://autbor.com/3" class="calibre1">https://<wbr></wbr>autbor<wbr></wbr>.com<wbr></wbr>/3</a></i> では本書で紹介したプログラムの動作を確認できます。</p>
</section>
<section type="division" aria-labelledby="sec10">
<h2 class="h" id="calibre_link-1393"><span id="calibre_link-13"></span><span class="sans_futura_std_bold_b_">Pythonのダウンロードとインストール</span></h2>
<p class="tni">Windows、macOS、Ubuntu（Linux）用のPythonを <i class="calibre5"><a href="https://python.org/downloads" class="calibre1">https://<wbr></wbr>python<wbr></wbr>.org<wbr></wbr>/downloads</a></i> から無料でダウンロードできます。</p>
<p class="tx">ダウンロードページはお使いのOSに応じたパッケージのダウンロードを勧めてくれます。AndroidとiOS用の非公式のPythonインストーラーも存在しますが、本書では扱いません。Windows、macOS、Linuxでインストールオプションがいろいろあります。OSに応じたインストーラーをダウンロードして実行し、Pythonインタープリタソフトウェアをインストールしてください。</p>
<p class="tx">PythonやOSのバージョンによってはインストールの手順が異なる場合があります。うまくいかないときは  <i class="calibre5"><a href="https://autbor.com/install/" class="calibre1">https://<wbr></wbr>autbor<wbr></wbr>.com<wbr></wbr>/install<wbr></wbr>/</a></i> で最新のインストール方法をご参照ください。</p>
</section>
<section type="division" aria-labelledby="sec11">
<h2 class="h" id="calibre_link-1394"><span id="calibre_link-14"></span><span class="sans_futura_std_bold_b_">Muのダウンロードとインストール</span></h2>
<p class="tni">前節で紹介した<i class="calibre5">Pythonインタープリタ</i>はPythonプログラムを実行するソフトウェアであるのに対し、本節で紹介する<i class="calibre5">Muエディタ</i> はワープロで文書を作成するのと同じ要領でプログラムを書くソフトウェアです。<i class="calibre5"><a href="https://codewith.mu" class="calibre1">https://<wbr></wbr>codewith<wbr></wbr>.mu</a></i> からMuをダウンロードできます。</p>
<p class="tx"><span role="doc-pagebreak" type="pagebreak" id="calibre_link-1154" aria-label="xl"></span>WindowsとmacOSでは、OSに応じたインストーラーをダウンロードしてダブルクリックして実行します。macOSをお使いでしたら、インストーラーを実行するとウィンドウが開くので、Muのアイコンをアプリケーションフォルダアイコンにドラッグしてインストールを継続します。Ubuntuをお使いでしたら、MuをPythonのパッケージとしてインストールします。ダウンロードページのPython Packageセクションにある<b class="calibre10">Instructions</b>ボタンをクリックします。</p>
</section>
<section type="division" aria-labelledby="sec12">
<h2 class="h" id="calibre_link-1395"><span id="calibre_link-15"></span><span class="sans_futura_std_bold_b_">Muの起動</span></h2>
<p class="tni">インストール後は以下のようにしてMuを起動します。</p>
<ul class="ul">
<li class="bl">Windowsでは、画面左下のスタートアイコンをクリックし、検索ボックスに<b class="calibre10">Mu Editor</b>と入力して選びます。</li>
<li class="bl">macOSでは、Finderウィンドウを開き、<b class="calibre10">Applications</b>をクリックしてから<b class="calibre10">mu-editor</b>をクリックします。Spotlightから<b class="calibre10">Mu Editor</b>を実行することもできます。</li>
<li class="bl">Ubuntuでは、<b class="calibre10">Applications</b><span class="listbullet_menuarrow"></span><b class="calibre10">Accessories</b><span class="listbullet_menuarrow"></span><b class="calibre10">Terminal</b>の順に選択してターミナルを起動して、<span class="sans_thesansmonocd_w7bold_b_">python3 –m mu</span>を実行します。</li>
</ul>
<p class="tx">Muの初回起動時には、モードの選択ウィンドウが表示されます。Adafruit CircuitPython、BBC micro:bit、Pygame Zero、Python 3その他の選択肢があります。<b class="calibre10">Python 3</b>を選んでください。後からでもエディタ画面上部の <b class="calibre10">モード</b>ボタンをクリックすれば変更できます。</p>
</section>
<section type="division" aria-labelledby="sec13">
<h2 class="h" id="calibre_link-1396"><span id="calibre_link-16"></span><span class="sans_futura_std_bold_b_">IDLEの起動</span></h2>
<p class="tni">本書ではエディタと対話型シェルにMuを用いますが、他のエディタを使用しても構いません。<i class="calibre5">interactive development environment (IDLE)</i>がPythonといっしょにインストールされますから、Muがうまく使えない場合にはIDLEをご利用ください。以下ではIDLEの使い方を説明します（Pythonのバージョンは3.13だと仮定します）。</p>
<ul class="ul">
<li class="bl">Windowsでは、画面左下のスタートアイコンをクリックし、検索ボックスに <b class="calibre10">IDLE</b>と入力して<b class="calibre10">IDLE (Python 3.13 64-bit)</b>を選びます。</li>
<li class="bl">macOSでは、Finderウィンドウを開き、<b class="calibre10">Applications</b>,をクリックしてから<b class="calibre10">Python 3.13</b>をクリックし、IDLEアイコンをクリックします。SpotlightからIDLEを実行することもできます。</li>
<li class="bl">Ubuntuでは、<b class="calibre10">Applications</b><span class="listbullet_menuarrow"></span><b class="calibre10">Accessories</b><span class="listbullet_menuarrow"></span><b class="calibre10">Terminal</b>の順に選択してターミナルを起動して、<span class="sans_thesansmonocd_w7bold_b_">idle</span>を実行します（Ubuntuのサイドバーの<b class="calibre10">Show Apps</b>をクリックして<b class="calibre10">IDLE</b>をクリックしても起動できます）。</li>
</ul>
</section>
<section type="division" aria-labelledby="sec14">
<h2 class="h" id="calibre_link-1397"><span id="calibre_link-17"></span><span class="sans_futura_std_bold_b_">対話型シェル</span></h2>
<p class="tni">Muを起動すると、<i class="calibre5">file editor</i>ウィンドウが表示されます。REPLボタンをクリックすると<i class="calibre5">対話型シェル</i>が開きます。シェルはコンピュータに命令できるプログラムです。macOSのターミナルやWindowsのコマンドプロンプトに似ています。Python対話型シェルに入力した命令はすぐにPythonのインタープリタによって実行されます。</p>
<p class="tx">Muでは、以下のような対話型シェルがウィンドウの下半分の枠に表示されます。</p>
<pre class="pre"><code class="calibre9"><span class="thesansmonocd_w5regular_">Jupyter QtConsole
Python 3
Type 'copyright', 'credits' or 'license' for more information
IPython -- An enhanced Interactive Python. Type '?' for help.</span>

<span class="thesansmonocd_w5regular_">In [1]:</span>
</code></pre>
<p class="tx">IDLEを実行すると、まず対話型シェルのウィンドウが立ち上がります。以下のようなほぼ空白のウィンドウが表示されます。</p>
<pre class="pre"><code class="calibre9"><span class="thesansmonocd_w5regular_">&gt;&gt;&gt;</span></code></pre>
<p class="tx"><span class="thesansmonocd_w5regular_">In [1]:</span> と <span class="thesansmonocd_w5regular_">&gt;&gt;&gt;</span> は <i class="calibre5">プロンプト</i>と呼ばれます。本書では <span class="thesansmonocd_w5regular_">&gt;&gt;&gt;</span> で対話型シェルのプロンプトを表します。これは一般的な表記です。ターミナルまたはコマンドプロンプトからPythonを実行するときにも、 <span class="thesansmonocd_w5regular_">&gt;&gt;&gt;</span> というプロンプトが表示されます。<span class="thesansmonocd_w5regular_">In [1]:</span> というプロンプトはJupyter Notebookというまた別のPythonエディタによるものです。</p>
<p class="tx">例えば、以下の内容を対話型シェルのプロンプトに続けて入力してください。</p>
<pre class="pre"><code class="calibre9"><span class="thesansmonocd_w5regular_">&gt;&gt;&gt;</span> <b class="calibre10">print('Hello, world!')</b></code></pre>
<p class="tx">この行を入力して<small class="calibre4">エンター</small>キーを押すと、対話型シェルは次のように反応します。</p>
<pre class="pre"><code class="calibre9"><span class="thesansmonocd_w5regular_">&gt;&gt;&gt;</span> <b class="calibre10">print('Hello, world!')</b>
<span class="thesansmonocd_w5regular_">Hello, world!</span>
</code></pre>
<p class="tx">コンピュータに指示を与え、指示した内容を実行させました。</p>
</section>
<section type="division" aria-labelledby="sec15">
<h2 class="h" id="calibre_link-1398"><span id="calibre_link-18"></span><span class="sans_futura_std_bold_b_">ヘルプの見つけ方</span></h2>
<p class="tni">プログラマはインターネットを検索して疑問を解消しながら学習を進める傾向にあります。これは多くの人がなじんできた、教師が講義と質疑応答を行う学習方法とは異なります。学習にインターネットを用いる大きな利点は、問題の解決を助けてくれる人たちのコミュニティが存在することです。実際、自分が抱いた疑問はおそらくすでに誰かが答えてくれていて、その回答がオンラインに準備されています。エラーメッセージを目にしたりコードを動かすのに苦労しているとしたら、同じ問題をほかの人がすでに経験しているでしょうから、解決策を見つけるのは意外と簡単です。</p>
<p class="tx"><span role="doc-pagebreak" type="pagebreak" id="calibre_link-1399" aria-label="xlii"></span>一例として、意図的にエラーを発生させてみましょう。<span class="sans_thesansmonocd_w7bold_b_">'42'</span> <span class="sans_thesansmonocd_w7bold_b_">+</span> <span class="sans_thesansmonocd_w7bold_b_">3</span> と対話型シェルに入力してください。この命令がどういう意味なのか現時点ではわからなくても大丈夫です。以下のような結果が表示されるはずです。</p>
<pre class="pre"><code class="calibre9"><span class="thesansmonocd_w5regular_">&gt;&gt;&gt;</span> <b class="calibre10">'42' + 3</b>
<span class="codeannotated_codeannotation" aria-label="annotation1">❶</span> <span class="thesansmonocd_w5regular_">Traceback (most recent call last):
  File "&lt;pyshell#0&gt;", line 1, in &lt;module&gt;
    '42' + 3</span>
<span class="codeannotated_codeannotation" aria-label="annotation2">❷</span> <span class="thesansmonocd_w5regular_">TypeError: can only concatenate str (not "int") to str
&gt;&gt;&gt;</span>
</code></pre>
<p class="tx">Pythonがこの命令を理解できなかったためにエラーメッセージが表示されます<span class="codeannotation" aria-label="annotation2">(❷)</span>。エラーメッセージのtracebackの部分<span class="codeannotation" aria-label="annotation1">(❶)</span>にエラーの原因となった命令と行番号が表示されています。エラーメッセージの意味がわからなかったとしても、オンラインで検索できます。検索エンジンで<b class="calibre10">“TypeError: can only concatenate str (not "int") to str”</b>とクォーテーションマークを含めてエラーメッセージを入力して検索してみてください。図2のように、このエラーメッセージの意味と原因を説明するリンクがたくさん見つかるはずです。</p>
<figure class="img"><img class="img1" id="calibre_link-650" src="images/000055.jpg" alt="An internet browser window showing search results for the message “TypeError: can only concatenate str (not “int”) to str.” Results include the websites Stack Overflow and Python Pool." />
<figcaption><p class="cap"><span class="sans_futura_std_book_oblique_i_">図2：Googleでエラーメッセージを検索すると大きな助けが得られます。</span></p></figcaption>
</figure>
<p class="tx">すでに誰かが同じ質問をして回答が付いているのがわかるでしょう。プログラムのすべてを知っている人などいませんから、ソフトウェア開発者は誰でも日常的に技術的な疑問の回答を調べています。</p>
</section>
<section type="division" aria-labelledby="sec16">
<h2 class="h" id="calibre_link-1400"><span id="calibre_link-19"></span><span class="sans_futura_std_bold_b_">プログラミングの利口な質問をする</span></h2>
<p class="tni">オンラインで検索しても回答が見つからなければ、Stack Overflow (<i class="calibre5"><a href="https://stackoverflow.com" class="calibre1">https://<wbr></wbr>stackoverflow<wbr></wbr>.com</a></i> )やredditの“learn programming”( <i class="calibre5"><a href="https://reddit.com/r/learnprogramming" class="calibre1">https://<wbr></wbr>reddit<wbr></wbr>.com<wbr></wbr>/r<wbr></wbr>/learnprogramming</a></i> )のようなウェブフォーラムで質問してみてください。ただし、プログラミングの利口な質問をするように心がけてください。まず、ウェブフォーラムのFAQ（よくある質問）を熟読し、質問を投稿する方法を調べます。</p>
<p class="tx">プログラミングの質問をする際には、以下の点に注意してください。</p>
<ul class="ul">
<li class="bl">やったことだけでなく、やろうとしていること（そのプログラムの目的）を説明してください。方針が間違っているという回答が得られるかもしれません。</li>
<li class="bl">エラーが発生する箇所を特定してください。プログラムを実行した瞬間にエラーが発生するのか、特定の行動を取った後にだけ発生するのかなどです。</li>
<li class="bl">エラーメッセージとコード<i class="calibre5">全体</i>を <i class="calibre5"><a href="https://pastebin.com" class="calibre1">https://<wbr></wbr>pastebin<wbr></wbr>.com</a></i> や <i class="calibre5"><a href="https://gist.github.com" class="calibre1">https://<wbr></wbr>gist<wbr></wbr>.github<wbr></wbr>.com</a></i> にコピーして貼り付けてください。これらのサイトでは、フォーマットもそのままに、大量のコードをオンラインで共有できます。共有URLをフォーラムに投稿します。例えば、 <i class="calibre5"><a href="https://pastebin.com/2k3LqDsd" class="calibre1">https://<wbr></wbr>pastebin<wbr></wbr>.com<wbr></wbr>/2k3LqDsd</a></i> や <i class="calibre5"><a href="https://gist.github.com/asweigart/6912168" class="calibre1">https://<wbr></wbr>gist<wbr></wbr>.github<wbr></wbr>.com<wbr></wbr>/asweigart<wbr></wbr>/6912168</a></i> に筆者が投稿した例があります。</li>
<li class="bl">問題を解決するためにすでに試したことを説明してください。そうすることで、自分で解決に向けて努力したことが伝わります。</li>
<li class="bl">お使いのPythonのバージョンと、プログラムを実行したOSとそのバージョンを書いてください。</li>
<li class="bl">コードに変更を加えた後にエラーが発生するようになったのであれば、どこを変更したかを説明してください。</li>
<li class="bl">プログラミングを実行すると毎回エラーを再現できるのか、それとも特定の行動を取った後にだけエラーが発生するのかを書いてください。後者の場合、どういう行動を取るとエラーが発生するのかを説明してください。</li>
</ul>
<p class="tx">オンライン上でのエチケットに従ってください。例えば、質問文を過度に強調したり過大な要求をしたりしないでください。</p>
<p class="tx"><i class="calibre5"><a href="https://autbor.com/help" class="calibre1">https://<wbr></wbr>autbor<wbr></wbr>.com<wbr></wbr>/help</a></i> のブログ記事でプログラミングの質問の仕方をもっと詳細に説明しています。筆者はみなさんがPythonを利用するのを助けたいと思っており、<i class="calibre5"><a href="https://inventwithpython.com/blog" class="calibre1">https://<wbr></wbr>inventwithpython<wbr></wbr>.com<wbr></wbr>/blog</a></i> のブログ記事でプログラミングのチュートリアルを書きました。<i class="calibre5">al@inventwithpython.com</i> にメールを送っていただいても構いませんが、 <i class="calibre5"><a href="https://reddit.com/r/inventwithpython" class="calibre1">https://<wbr></wbr>reddit<wbr></wbr>.com<wbr></wbr>/r<wbr></wbr>/inventwithpython</a></i> に質問を投稿したほうが早いでしょう。</p>
</section>
<section type="division" aria-labelledby="sec17">
<h2 class="h" id="calibre_link-1402"><span id="calibre_link-20"></span><span class="sans_futura_std_bold_b_">第3版での変更点</span></h2>
<p class="tni">全面的に改訂して更新したこの第3版では、新しいプログラミングプロジェクトを16個追加したので、学習したスキルをしっかりと練習できます。Pythonのsqlite3モジュールを使ったSQLiteリレーショナルデータベースの導入も加筆しました。PythonのスクリプトをWindows、macOS、Linuxでの実行ファイルにコンパイルする方法も書き加えました。コマンドラインプログラムの作成と実行も扱いました。PyPDFとPdfMineを使ったPDFの操作、Seleniumに加えてPlaywrightを利用したウェブブラウザの制御、文字認識、OpenAIのWhisperライブラリを利用した音声ファイルや動画ファイルからの音声認識、PyTesseractによる画像中の文字認識、Matplotlibによるグラフ作成など、新しい内容がてんこ盛りです。</p>
</section>
<section type="conclusion" role="doc-conclusion" aria-labelledby="sec18">
<h2 class="h" id="calibre_link-1404"><span id="calibre_link-21"></span><span class="sans_futura_std_bold_b_">まとめ</span></h2>
<p class="tni">ほとんどの人にとって、コンピュータはツールではなくただの家電製品です。しかしプログラミングを学ぶと、現代の最も強力なツールにアクセスできるようになり、楽しいです。プログラミングは脳外科手術ではありません。素人が実験して間違えても問題ありません。</p>
<p class="tx">本書を読むのに事前のプログラミング知識は必要ありません。かなりたくさんの内容を説明しますが、本書の範囲を超えた疑問が生じるかもしれません。効果的に質問して回答を得る方法を知ることは、プログラミング人生において計り知れないほどの価値があります。</p>
<p class="tx">それでは始めましょう。</p>
</section>
</section>
</div>


</div>



</body></html>