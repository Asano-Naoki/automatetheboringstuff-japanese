<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><link href="style.css" rel="stylesheet" type="text/css" /><title>Pythonで退屈な作業を自動化する
</title></head><body><div type="frontmatter" class="calibre" id="calibre_link-0">




<div type="backmatter" class="calibre" id="calibre_link-637">
<section type="appendix" role="doc-appendix" aria-labelledby="app1">
<span role="doc-pagebreak" type="pagebreak" id="calibre_link-1273" aria-label="577"></span>
<hgroup>
<h2 class="title" id="calibre_link-2138">
<span class="tpt"><span class="sans_dogma_ot_bold_b_">A</span></span> <span class="ct"><span class="sans_dogma_ot_bold_b_">サードパーティのパッケージのインストール</span></span>
</h2>
</hgroup>
<figure class="opener"><img class="opener1" src="images/000112.jpg" role="presentation" alt="" />
</figure>
<p class="introtni">独自のモジュールを書き、PythonのできることをPythonに付属している標準ライブラリよりも拡張している開発者は多いです。Pythonに付属しているpipツールを使えば、サードパーティーパッケージにアクセスできます。pipは、Pythonモジュールの無料アプリストアであるPython Package Index（PyPI）サイトから、自分が使っているコンピュータに、モジュールを安全にダウンロードしてインストールします。本付録では、本書を通じて用いられているパッケージをインストールする方法を説明します。</p>
<p class="tx">コマンドライン、仮想環境、パッケージ、モジュールの一般的な説明は、<span>第12章</span>をご覧ください。</p>
<section type="division" aria-labelledby="sec1">
<span role="doc-pagebreak" type="pagebreak" id="calibre_link-923" aria-label="578"></span>
<h2 class="h" id="calibre_link-2139"><span id="calibre_link-638"></span><span class="sans_futura_std_bold_b_">pipをインストールする</span></h2>
<p class="tni">pipツールの実行ファイルは、Windowsでは<span class="thesansmonocd_w5regular_">pip</span>、macOSとLinuxでは<span class="thesansmonocd_w5regular_">pip3</span>です。Pythonのバージョン3.4以降ではpipツールが同梱されています。しかし、Linuxのディストリビューションによっては、前もってインストールされていないかもしれません。</p>
<p class="tx">pip3をインストールするには、新しいターミナルウィンドウを開いて、Ubuntuその他のDebian系のLinuxでは<b class="calibre10">sudo apt install python3-pip</b>、Fedoraその他のRed Hat系のLinuxでは<b class="calibre10">sudo yum install python3-pip</b>と入力します。管理者パスワードの入力を求められます。</p>
</section>
<section type="division" aria-labelledby="sec2">
<h2 class="h" id="calibre_link-2140"><span id="calibre_link-639"></span><span class="sans_futura_std_bold_b_">pipを見つける</span></h2>
<p class="tni">pipのフォルダが<span class="thesansmonocd_w5regular_">PATH</span>環境変数に含まれていなければ、pipを実行する前に<span class="thesansmonocd_w5regular_">cd</span>コマンドでターミナルウィンドウのディレクトリを移動しなければならない可能性があります。Windowsなら<span class="thesansmonocd_w5regular_">echo %USERNAME%</span>、macOSとLinuxなら<span class="thesansmonocd_w5regular_">whoami</span>を実行して、まずユーザー名を調べてください。</p>
<p class="tx">次に、Windowsなら以下のコマンドを実行します。ユーザー名は自分のユーザー名にして、Pythonのバージョンのフォルダ名はお使いのバージョンに調整してください。</p>
<pre class="pre"><code class="calibre9">C:\Users\al&gt;<b class="calibre10">cd C:\Users\</b><span class="sans_thesansmonocd_w7bold_italic_bi_">your_username</span><b class="calibre10">\AppData\Local\Programs\Python\Python313\Scripts</b></code></pre>
<p class="tx">macOSでは、以下のコマンドを実行します（Pythonのバージョンのフォルダ名を調整してください）。</p>
<pre class="pre"><code class="calibre9">al@Als-MacBook-Pro ~ %<b class="calibre10">cd /Library/Frameworks/Python.framework/Versions/3.13/bin/</b></code></pre>
<p class="tx">Linuxでは、ユーザー名を自分のユーザー名にして、以下のコマンドを実行します。</p>
<pre class="pre"><code class="calibre9">al@al-VirtualBox:~$ <b class="calibre10">cd /home/</b><span class="sans_thesansmonocd_w7bold_italic_bi_">your_username</span><b class="calibre10">/.local/bin/</b></code></pre>
<p class="tx">これでpipツールを実行できるフォルダにいるはずです。移動する代わりに、<span>第12章の「PATH環境変数」</span>の指示に従って、そのフォルダを<span class="thesansmonocd_w5regular_">PATH</span>環境変数に追加することもできます。</p>
</section>
<section type="division" aria-labelledby="sec3">
<h2 class="h" id="calibre_link-2141"><span id="calibre_link-640"></span><span class="sans_futura_std_bold_b_">仮想環境からpipを実行する</span></h2>
<p class="tni">OSによっては、Python組み込みの<span class="thesansmonocd_w5regular_">venv</span>モジュールを使って仮想環境を作成して有効化してからでないとpipを実行できないかもしれません。Pythonの学習と実験であれば、すべてのプログラムで一つの仮想環境を用いてもよいでしょう。詳しくは<span>第12章の「仮想環境」</span>をご参照ください。</p>
</section>
<section type="division" aria-labelledby="sec4">
<h2 class="h" id="calibre_link-2142"><span id="calibre_link-641"></span><span class="sans_futura_std_bold_b_">本書で用いられているパッケージのインストール</span></h2>
<p class="tni">サードパーティーパッケージが本書執筆後に変更されて本書のコード例と互換性が保たれないかもしれないので、モジュール名のあとに<span class="thesansmonocd_w5regular_">==</span>をつけて本書と同じ<span class="sans_thesansmonocd_w5regular_italic_">バージョン</span>をインストールすることをおすすめします（コマンドラインオプションはイコール記号2つです）。例えば、<span class="thesansmonocd_w5regular_">pip install send2trash==1.8.3</span>を実行すると、send2trashパッケージのバージョン1.8.3 をインストールします。</p>
<p class="tx">automateboringstuff3パッケージをインストールすると、互換性のあるパッケージを一度で簡単にまとめてインストールできます。サードパーティーパッケージの新しいバージョンが登場すれば、本書のコード例と互換性がある限り、このパッケージのバージョンを更新します。最新のバージョンのサードパーティーパッケージをインストールしたい場合は、オンラインドキュメントを参照して更新情報を確認してください。</p>
<p class="tx">Windowsでは、以下のコマンドを実行します。</p>
<pre class="pre"><code class="calibre9">C:\Users\al&gt;<b class="calibre10">python –m pip install automateboringstuff3</b></code></pre>
<p class="tx">macOSとLinuxでは、以下のコマンドを実行します。</p>
<pre class="pre"><code class="calibre9">al@Als-MacBook-Pro ~ % <b class="calibre10">python3 –m pip install automateboringstuff3</b></code></pre>
<p class="tx">Linuxで<span>第23章</span>のPyAutoGUIパッケージをインストールするためには、追加のステップが必要になります。ターミナルウィンドウを開いて<b class="calibre10">sudo apt install python3-tk</b>と<b class="calibre10">sudo apt install python3-dev</b>を実行してください。<span>第8章</span>の<span class="thesansmonocd_w5regular_">pyperclip</span>モジュールをLinuxで動作させるためには、<b class="calibre10">sudo apt install xclip</b>を実行してください。管理者パスワードの入力を求められます。</p>
<p class="tx">本書の出版時点では、以下のバージョンを使用しています。</p>
<pre class="pre"><code class="calibre9">beautifulsoup4 == 4.12.3
matplotlib==3.92
openpyxl==3.1.5
pdfminer.six==20240706
pillow==10.4.0
playsound3==2.4.0
playwright==1.47.0
PyPDF==5.0.1
python-docx==1.1.2
pyttsx3 == 2.98
requests==2.32.3
selenium==4.25.0
send2trash==1.8.3
xmltodict==0.13.0
</code></pre>
<p class="tx">automateboringstuff3パッケージでは、これに加えて、以下のパッケージの最新版をインストールします。</p>
<pre class="pre"><code class="calibre9">bext
ezgmail
ezsheets
humre
pyautogui
pymsgbox
pyperclip
<span role="doc-pagebreak" type="pagebreak" id="calibre_link-2144" aria-label="580"></span>pyperclipimg
yt-dlp
</code></pre>
<p class="tx">Playwrightパッケージでは、モジュール用のブラウザをインストールするというステップも必要になります。automateboringstuff3パッケージをインストールしてから、<b class="calibre10">playwright install</b>を実行してPlaywrightが使うブラウザをインストールしてください。</p>
<p class="tx"><span>第22章</span>で取り上げたpytesseractパッケージと<span>第24章</span>で取り上げたopenai-whisperパッケージは、サイズが大きく、インストールしたくない人がいるかもしれませんから、automateboringstuff3パッケージには含めませんでした。Windowsなら以下のコマンドを実行してインストールできます。</p>
<pre class="pre"><code class="calibre9">C:\Users\al&gt;<b class="calibre10">pip install pytesseract==0.3.10</b>
C:\Users\al&gt;<b class="calibre10">pip install openai-whisper==20231117</b>
</code></pre>
<p class="tx">macOSとLinuxなら以下のコマンドを実行してインストールできます。</p>
<pre class="pre"><code class="calibre9">al@Als-MacBook-Pro ~ % <b class="calibre10">pip3 install pytesseract==0.3.10</b>
al@Als-MacBook-Pro ~ % <b class="calibre10">pip3 install openai-whisper==20231117</b>
</code></pre>
<p class="tx">Windowsをお使いでしたら、Whisperをインストールする際に次のようなエラーが表示されるかもしれません。
</p>
<pre class="pre"><code class="calibre9">A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.0.1 as it may crash
</code></pre>
<p class="tx"><span class="thesansmonocd_w5regular_">pip install "numpy&lt;2"</span>を実行してNumPyをダウングレードすればこの互換性問題を解決できます。ダブルクォートを忘れないようにしてください。</p>
<p class="tx">以下のコマンドを実行すると、Whisperパッケージが、お使いのコンピュータのNVIDIAのグラフィックカード（GPU）を利用して音声認識を高速で実行できるようになります。</p>
<pre class="pre"><code class="calibre9">C:\Users\al&gt;<b class="calibre10">pip install torch torchvision torchaudio --index-url </b>
<b class="calibre10">https://download.pytorch.org/whl/cu118</b>
</code></pre>
<p class="tx">お使いのコンピュータにNVIDIAのGPUがなければ（MacBookにはありません）この機能は使えません。</p>
</section>
</section>
</div>



</div>



</body></html>